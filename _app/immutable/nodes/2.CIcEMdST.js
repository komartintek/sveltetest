import{t as O,a as M}from"../chunks/D2Stmfmf.js";import{i as ke}from"../chunks/B7I6-3Av.js";import{h as K,d as He,b as Ke,q as l,ac as be,r as Re,e as De,f as pe,s as ne,g as le,k as Q,a0 as Fe,i as Ae,j as Ie,p as $e,a4 as Se,Y as Be,o as z,aq as ve,ar as oe,Q as me,as as _e,at as he,au as Ge,a3 as ze,av as Ve,D as Ye,aw as de,ax as Je,_ as Ue,O as Xe,N as We,ay as Ee,X as Qe,az as je,aA as Ze,aB as ea,aC as aa,aD as ra,a as ta,a7 as na,a6 as xe,aE as la,v as q,G as Te,aF as we,aG as Ne,M as I,F as re,J as Le,K as G,L as H,I as W,af as oa,aH as ia,aI as V}from"../chunks/tyx1Wf5t.js";import{a as sa,l as Me,e as ue,s as j}from"../chunks/CEJI1F-9.js";import{i as X,s as va,a as ua}from"../chunks/CvpLTT5_.js";import{w as fa}from"../chunks/B0QSapgM.js";function ee(e,a){return a}function ca(e,a,t,i){for(var r=[],o=a.length,f=0;f<o;f++)Ge(a[f].e,r,!0);var _=o>0&&r.length===0&&t!==null;if(_){var E=t.parentNode;ze(E),E.append(t),i.clear(),B(e,a[0].prev,a[o-1].next)}Ve(r,()=>{for(var b=0;b<o;b++){var d=a[b];_||(i.delete(d.k),B(e,d.prev,d.next)),Ye(d.e,!_)}})}function ae(e,a,t,i,r,o=null){var f=e,_={flags:a,items:new Map,first:null},E=(a&Ee)!==0;if(E){var b=e;f=K?ne(Xe(b)):b.appendChild(We())}K&&He();var d=null,C=!1,v=be(()=>{var h=t();return Be(h)?h:h==null?[]:Se(h)});Ke(()=>{var h=l(v),n=h.length;if(C&&n===0)return;C=n===0;let k=!1;if(K){var s=Re(f)===De;s!==(n===0)&&(f=pe(),ne(f),le(!1),k=!0)}if(K){for(var p=null,g,y=0;y<n;y++){if(Q.nodeType===8&&Q.data===Fe){f=Q,k=!0,le(!1);break}var u=h[y],c=i(u,y);g=Oe(Q,_,p,null,u,c,y,r,a,t),_.items.set(c,g),p=g}n>0&&ne(pe())}K||_a(h,_,f,r,a,i,t),o!==null&&(n===0?d?Ae(d):d=Ie(()=>o(f)):d!==null&&$e(d,()=>{d=null})),k&&le(!0),l(v)}),K&&(f=Q)}function _a(e,a,t,i,r,o,f){var m,N,L,S;var _=(r&je)!==0,E=(r&(de|_e))!==0,b=e.length,d=a.items,C=a.first,v=C,h,n=null,k,s=[],p=[],g,y,u,c;if(_)for(c=0;c<b;c+=1)g=e[c],y=o(g,c),u=d.get(y),u!==void 0&&((m=u.a)==null||m.measure(),(k??(k=new Set)).add(u));for(c=0;c<b;c+=1){if(g=e[c],y=o(g,c),u=d.get(y),u===void 0){var P=v?v.e.nodes_start:t;n=Oe(P,a,n,n===null?a.first:n.next,g,y,c,i,r,f),d.set(y,n),s=[],p=[],v=n.next;continue}if(E&&da(u,g,c,r),(u.e.f&oe)!==0&&(Ae(u.e),_&&((N=u.a)==null||N.unfix(),(k??(k=new Set)).delete(u))),u!==v){if(h!==void 0&&h.has(u)){if(s.length<p.length){var x=p[0],A;n=x.prev;var D=s[0],T=s[s.length-1];for(A=0;A<s.length;A+=1)ge(s[A],x,t);for(A=0;A<p.length;A+=1)h.delete(p[A]);B(a,D.prev,T.next),B(a,n,D),B(a,T,x),v=x,n=T,c-=1,s=[],p=[]}else h.delete(u),ge(u,v,t),B(a,u.prev,u.next),B(a,u,n===null?a.first:n.next),B(a,n,u),n=u;continue}for(s=[],p=[];v!==null&&v.k!==y;)(v.e.f&oe)===0&&(h??(h=new Set)).add(v),p.push(v),v=v.next;if(v===null)continue;u=v}s.push(u),n=u,v=u.next}if(v!==null||h!==void 0){for(var w=h===void 0?[]:Se(h);v!==null;)(v.e.f&oe)===0&&w.push(v),v=v.next;var R=w.length;if(R>0){var U=(r&Ee)!==0&&b===0?t:null;if(_){for(c=0;c<R;c+=1)(L=w[c].a)==null||L.measure();for(c=0;c<R;c+=1)(S=w[c].a)==null||S.fix()}ca(a,w,U,d)}}_&&Qe(()=>{var F;if(k!==void 0)for(u of k)(F=u.a)==null||F.apply()}),me.first=a.first&&a.first.e,me.last=n&&n.e}function da(e,a,t,i){(i&de)!==0&&he(e.v,a),(i&_e)!==0?he(e.i,t):e.i=t}function Oe(e,a,t,i,r,o,f,_,E,b){var d=(E&de)!==0,C=(E&Je)===0,v=d?C?z(r):ve(r):r,h=(E&_e)===0?f:ve(f),n={i:h,v,k:o,a:null,e:null,prev:t,next:i};try{return n.e=Ie(()=>_(e,v,h,b),K),n.e.prev=t&&t.e,n.e.next=i&&i.e,t===null?a.first=n:(t.next=n,t.e.next=n.e),i!==null&&(i.prev=n,i.e.prev=n.e),n}finally{}}function ge(e,a,t){for(var i=e.next?e.next.e.nodes_start:t,r=a?a.e.nodes_start:t,o=e.e.nodes_start;o!==i;){var f=Ue(o);r.before(o),o=f}}function B(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}const pa=Symbol("is custom element"),ma=Symbol("is html");function Y(e){if(K){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var i=e.value;ye(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var r=e.checked;ye(e,"checked",null),e.checked=r}}};e.__on_r=t,Ze(t),sa()}}function ye(e,a,t,i){var r=ha(e);K&&(r[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||r[a]!==(r[a]=t)&&(a==="loading"&&(e[ea]=t),e.removeAttribute(a))}function ha(e){return e.__attributes??(e.__attributes={[pa]:e.nodeName.includes("-"),[ma]:e.namespaceURI===aa})}function J(e,a,t=a){var i=ra();Me(e,"input",r=>{var o=r?e.defaultValue:e.value;if(o=ie(e)?se(o):o,t(o),i&&o!==(o=a())){var f=e.selectionStart,_=e.selectionEnd;e.value=o??"",_!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(_,e.value.length))}}),(K&&e.defaultValue!==e.value||ta(a)==null&&e.value)&&t(ie(e)?se(e.value):e.value),na(()=>{var r=a();ie(e)&&r===se(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function ie(e){var a=e.type;return a==="number"||a==="range"}function se(e){return e===""?null:+e}function Pe(e,a,t){if(e.multiple)return ka(e,a);for(var i of e.options){var r=Z(i);if(la(r,a)){i.selected=!0;return}}(!t||a!==void 0)&&(e.selectedIndex=-1)}function ga(e,a){xe(()=>{var t=new MutationObserver(()=>{var i=e.__value;Pe(e,i)});return t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function ya(e,a,t=a){var i=!0;Me(e,"change",r=>{var o=r?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(o),Z);else{var _=e.querySelector(o)??e.querySelector("option:not([disabled])");f=_&&Z(_)}t(f)}),xe(()=>{var r=a();if(Pe(e,r,i),i&&r===void 0){var o=e.querySelector(":checked");o!==null&&(r=Z(o),t(r))}e.__value=r,i=!1}),ga(e)}function ka(e,a){for(var t of e.options)t.selected=~a.indexOf(Z(t))}function Z(e){return"__value"in e?e.__value:e.value}function ba(e){var a=ve(0);return function(){return arguments.length===1?(q(a,l(a)+1),arguments[0]):(l(a),e())}}const fe="https://script.google.com/macros/s/AKfycbzqo_pcvWWD9L9XG5yEP9Bz33lHKRzA2q5tvS6aGTRoe03z6S3akp1FsN57wOtGYxqy/exec",Aa=localStorage.getItem("api_key"),ce=fa(Aa);ce.subscribe(e=>{localStorage.setItem("api_key",e||"")});var Ia=O("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Sa=O("<p>Laddar lagersaldo...</p>"),Ea=O('<p style="color: red;"> </p>'),xa=O("<th> </th>"),Ta=O("<td> </td>"),wa=O("<tr></tr>"),Na=O("<table><thead><tr></tr></thead><tbody></tbody></table>"),La=O("<p>Inget saldo tillgängligt.</p>"),Ma=O("<h2>Lagersaldo</h2> <!>",1);function Oa(e,a){Te(a,!1);const[t,i]=va(),r=()=>ua(ce,"$apiKey",t);let o=z([]),f=z(!1),_=z(null);async function E(){q(f,!0),q(_,null);try{console.log("Hämtar lagersaldo med nyckel:",r());const n=await fetch(`${fe}?key=${r()}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",n),!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const k=await n.json();console.log("JSON-data från lagersaldo-API:",k),q(o,Array.isArray(k.saldo)?k.saldo:[])}catch(n){console.error("Fel vid hämtning av lagersaldo:",n),q(_,n.message)}finally{q(f,!1)}}function b(){const n=prompt("Ange din API-nyckel:");n&&ce.set(n)}we(()=>r(),()=>{r()&&E()}),Ne(),ke();var d=Ma(),C=I(re(d),2);{var v=n=>{var k=Ia(),s=I(re(k),2);ue("click",s,b),M(n,k)},h=(n,k)=>{{var s=g=>{var y=Sa();M(g,y)},p=(g,y)=>{{var u=P=>{var x=Ea(),A=G(x,!0);H(x),W(()=>j(A,l(_))),M(P,x)},c=(P,x)=>{{var A=T=>{var w=Na(),R=G(w),U=G(R);ae(U,5,()=>Object.keys(l(o)[0]),ee,(N,L)=>{var S=xa(),F=G(S,!0);H(S),W(()=>j(F,l(L))),M(N,S)}),H(U),H(R);var m=I(R);ae(m,5,()=>l(o),ee,(N,L)=>{var S=wa();ae(S,5,()=>Object.values(l(L)),ee,(F,qe)=>{var te=Ta(),Ce=G(te,!0);H(te),W(()=>j(Ce,l(qe))),M(F,te)}),H(S),M(N,S)}),H(m),H(w),M(T,w)},D=T=>{var w=La();M(T,w)};X(P,T=>{Array.isArray(l(o))&&l(o).length>0?T(A):T(D,!1)},x)}};X(g,P=>{l(_)?P(u):P(c,!1)},y)}};X(n,g=>{l(f)?g(s):g(p,!1)},k)}};X(C,n=>{r()?n(h,!1):n(v)})}M(e,d),Le(),i()}const Pa=oa({value:localStorage.getItem("api_key")??""});var $=ba(()=>Pa),qa=O("<option> </option>"),Ca=O("<pre> </pre>"),Ha=O('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ka=O("<p>Laddar material eller saknar API-nyckel...</p>"),Ra=O('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Va(e,a){Te(a,!1);let t=z([]),i=z(null),r=z({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),o=z($().value||"");async function f(){try{console.log("Hämtar material med nyckel:",$().value);const p=await(await fetch(`${fe}?key=${$().value}&action=material`)).json();console.log("API-svar material:",p),q(t,Array.isArray(p.material)?p.material:[])}catch(s){console.error("Fel vid hämtning av material:",s),q(t,[])}}function _(){console.log("Sparar API-nyckel:",l(o)),$($().value=l(o)),f()}async function E(){q(i,null);try{console.log("Skickar bokning:",l(r));const p=await(await fetch(`${fe}?key=${$()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(l(r))})).json();console.log("API-svar bokning:",p),q(i,p)}catch(s){console.error("Fel vid bokning:",s),q(i,{error:s instanceof Error?s.message:String(s)})}}we(()=>$(),()=>{$().value&&f()}),Ne(),ke();var b=Ra(),d=I(re(b),2);Y(d);var C=I(d,2),v=I(C,2);{var h=s=>{var p=Ha(),g=re(p);W(()=>{l(r),ia(()=>{l(t)})});var y=G(g);y.value=y.__value="";var u=I(y);ae(u,1,()=>l(t),ee,(m,N)=>{var L=qa(),S={},F=G(L,!0);H(L),W(()=>{S!==(S=l(N).MaterialId)&&(L.value=(L.__value=l(N).MaterialId)??""),j(F,l(N).Namn)}),M(m,L)}),H(g);var c=I(g,2);Y(c);var P=I(c,2);Y(P);var x=I(P,2);Y(x);var A=I(x,4);Y(A);var D=I(A,2);Y(D);var T=I(D,2);Y(T);var w=I(T,2),R=I(w,2);{var U=m=>{var N=Ca(),L=G(N,!0);H(N),W(S=>j(L,S),[()=>JSON.stringify(l(i),null,2)],be),M(m,N)};X(R,m=>{l(i)&&m(U)})}ya(g,()=>l(r).materialId,m=>V(r,l(r).materialId=m)),J(c,()=>l(r).antal,m=>V(r,l(r).antal=m)),J(P,()=>l(r).från,m=>V(r,l(r).från=m)),J(x,()=>l(r).till,m=>V(r,l(r).till=m)),J(A,()=>l(r).ansvarig.namn,m=>V(r,l(r).ansvarig.namn=m)),J(D,()=>l(r).ansvarig.epost,m=>V(r,l(r).ansvarig.epost=m)),J(T,()=>l(r).ansvarig.telefonnummer,m=>V(r,l(r).ansvarig.telefonnummer=m)),ue("click",w,E),M(s,p)},n=s=>{var p=Ka();M(s,p)};X(v,s=>{Array.isArray(l(t))&&l(t).length>0?s(h):s(n,!1)})}var k=I(v,2);Oa(k,{}),J(d,()=>l(o),s=>q(o,s)),ue("click",C,_),M(e,b),Le()}export{Va as component};
