import{t as N,a as w}from"../chunks/i4SAYe-U.js";import{i as ke}from"../chunks/CS5ISnyU.js";import{h as $,d as Pe,b as Re,o,a6 as Ae,r as qe,e as De,f as pe,s as ie,g as se,k as Z,a0 as Fe,i as Ie,j as Ee,p as Ue,a4 as Se,Y as Be,m as Y,a7 as he,a8 as oe,Q as me,a9 as _e,aa as ge,ab as Ve,a3 as Je,ac as Ye,D as Ge,ad as de,ae as Qe,_ as Xe,O as je,N as We,af as xe,X as Ze,ag as ze,ah as ea,ai as aa,aj as ra,ak as ta,a as na,al as la,am as Te,an as ia,G as we,ao as Ne,ap as Le,M as I,F as ne,J as Me,v as H,K as J,L as C,I as W,aq as sa,ar as G}from"../chunks/DZVzPhGv.js";import{a as oa,l as Oe,e as ue,s as z}from"../chunks/mH8pkYhF.js";import{i as j,s as Ce,a as He}from"../chunks/DOuXPHa7.js";import{w as va}from"../chunks/DgQpC51A.js";function re(e,a){return a}function fa(e,a,r,v){for(var t=[],i=a.length,f=0;f<i;f++)Ve(a[f].e,t,!0);var l=i>0&&t.length===0&&r!==null;if(l){var b=r.parentNode;Je(b),b.append(r),v.clear(),V(e,a[0].prev,a[i-1].next)}Ye(t,()=>{for(var k=0;k<i;k++){var h=a[k];l||(v.delete(h.k),V(e,h.prev,h.next)),Ge(h.e,!l)}})}function te(e,a,r,v,t,i=null){var f=e,l={flags:a,items:new Map,first:null},b=(a&xe)!==0;if(b){var k=e;f=$?ie(je(k)):k.appendChild(We())}$&&Pe();var h=null,K=!1,u=Ae(()=>{var p=r();return Be(p)?p:p==null?[]:Se(p)});Re(()=>{var p=o(u),n=p.length;if(K&&n===0)return;K=n===0;let m=!1;if($){var y=qe(f)===De;y!==(n===0)&&(f=pe(),ie(f),se(!1),m=!0)}if($){for(var E=null,g,c=0;c<n;c++){if(Z.nodeType===8&&Z.data===Fe){f=Z,m=!0,se(!1);break}var s=p[c],_=v(s,c);g=Ke(Z,l,E,null,s,_,c,t,a,r),l.items.set(_,g),E=g}n>0&&ie(pe())}$||ua(p,l,f,t,a,v,r),i!==null&&(n===0?h?Ie(h):h=Ee(()=>i(f)):h!==null&&Ue(h,()=>{h=null})),m&&se(!0),o(u)}),$&&(f=Z)}function ua(e,a,r,v,t,i,f){var D,F,U,d;var l=(t&ze)!==0,b=(t&(de|_e))!==0,k=e.length,h=a.items,K=a.first,u=K,p,n=null,m,y=[],E=[],g,c,s,_;if(l)for(_=0;_<k;_+=1)g=e[_],c=i(g,_),s=h.get(c),s!==void 0&&((D=s.a)==null||D.measure(),(m??(m=new Set)).add(s));for(_=0;_<k;_+=1){if(g=e[_],c=i(g,_),s=h.get(c),s===void 0){var L=u?u.e.nodes_start:r;n=Ke(L,a,n,n===null?a.first:n.next,g,c,_,v,t,f),h.set(c,n),y=[],E=[],u=n.next;continue}if(b&&ca(s,g,_,t),(s.e.f&oe)!==0&&(Ie(s.e),l&&((F=s.a)==null||F.unfix(),(m??(m=new Set)).delete(s))),s!==u){if(p!==void 0&&p.has(s)){if(y.length<E.length){var M=E[0],A;n=M.prev;var R=y[0],x=y[y.length-1];for(A=0;A<y.length;A+=1)ye(y[A],M,r);for(A=0;A<E.length;A+=1)p.delete(E[A]);V(a,R.prev,x.next),V(a,n,R),V(a,x,M),u=M,n=x,_-=1,y=[],E=[]}else p.delete(s),ye(s,u,r),V(a,s.prev,s.next),V(a,s,n===null?a.first:n.next),V(a,n,s),n=s;continue}for(y=[],E=[];u!==null&&u.k!==c;)(u.e.f&oe)===0&&(p??(p=new Set)).add(u),E.push(u),u=u.next;if(u===null)continue;s=u}y.push(s),n=s,u=s.next}if(u!==null||p!==void 0){for(var S=p===void 0?[]:Se(p);u!==null;)(u.e.f&oe)===0&&S.push(u),u=u.next;var O=S.length;if(O>0){var q=(t&xe)!==0&&k===0?r:null;if(l){for(_=0;_<O;_+=1)(U=S[_].a)==null||U.measure();for(_=0;_<O;_+=1)(d=S[_].a)==null||d.fix()}fa(a,S,q,h)}}l&&Ze(()=>{var T;if(m!==void 0)for(s of m)(T=s.a)==null||T.apply()}),me.first=a.first&&a.first.e,me.last=n&&n.e}function ca(e,a,r,v){(v&de)!==0&&ge(e.v,a),(v&_e)!==0?ge(e.i,r):e.i=r}function Ke(e,a,r,v,t,i,f,l,b,k){var h=(b&de)!==0,K=(b&Qe)===0,u=h?K?Y(t):he(t):t,p=(b&_e)===0?f:he(f),n={i:p,v:u,k:i,a:null,e:null,prev:r,next:v};try{return n.e=Ee(()=>l(e,u,p,k),$),n.e.prev=r&&r.e,n.e.next=v&&v.e,r===null?a.first=n:(r.next=n,r.e.next=n.e),v!==null&&(v.prev=n,v.e.prev=n.e),n}finally{}}function ye(e,a,r){for(var v=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,i=e.e.nodes_start;i!==v;){var f=Xe(i);t.before(i),i=f}}function V(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const _a=Symbol("is custom element"),da=Symbol("is html");function Q(e){if($){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var v=e.value;be(e,"value",null),e.value=v}if(e.hasAttribute("checked")){var t=e.checked;be(e,"checked",null),e.checked=t}}};e.__on_r=r,ea(r),oa()}}function be(e,a,r,v){var t=pa(e);$&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[aa]=r),e.removeAttribute(a))}function pa(e){return e.__attributes??(e.__attributes={[_a]:e.nodeName.includes("-"),[da]:e.namespaceURI===ra})}function X(e,a,r=a){var v=ta();Oe(e,"input",t=>{var i=t?e.defaultValue:e.value;if(i=ve(e)?fe(i):i,r(i),v&&i!==(i=a())){var f=e.selectionStart,l=e.selectionEnd;e.value=i??"",l!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(l,e.value.length))}}),($&&e.defaultValue!==e.value||na(a)==null&&e.value)&&r(ve(e)?fe(e.value):e.value),la(()=>{var t=a();ve(e)&&t===fe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function ve(e){var a=e.type;return a==="number"||a==="range"}function fe(e){return e===""?null:+e}function $e(e,a,r){if(e.multiple)return ga(e,a);for(var v of e.options){var t=ee(v);if(ia(t,a)){v.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ha(e,a){Te(()=>{var r=new MutationObserver(()=>{var v=e.__value;$e(e,v)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ma(e,a,r=a){var v=!0;Oe(e,"change",t=>{var i=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(i),ee);else{var l=e.querySelector(i)??e.querySelector("option:not([disabled])");f=l&&ee(l)}r(f)}),Te(()=>{var t=a();if($e(e,t,v),v&&t===void 0){var i=e.querySelector(":checked");i!==null&&(t=ee(i),r(t))}e.__value=t,v=!1}),ha(e)}function ga(e,a){for(var r of e.options)r.selected=~a.indexOf(ee(r))}function ee(e){return"__value"in e?e.__value:e.value}const ce="https://script.google.com/macros/s/AKfycbx37QQFI7hnNU6Hv4E2AsZHBm4CO0u2uWko42K6grUJoEI4vI7krWXa1GxEADLZjH9x/exec",ya=localStorage.getItem("api_key"),ae=va(ya);ae.subscribe(e=>{localStorage.setItem("api_key",e||"")});var ba=N("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ka=N("<p>Laddar lagersaldo...</p>"),Aa=N('<p style="color: red;"> </p>'),Ia=N("<th> </th>"),Ea=N("<td> </td>"),Sa=N("<tr></tr>"),xa=N("<table><thead><tr></tr></thead><tbody></tbody></table>"),Ta=N("<p>Inget saldo tillgängligt.</p>"),wa=N("<h2>Lagersaldo</h2> <!>",1);function Na(e,a){we(a,!1);const[r,v]=Ce(),t=()=>He(ae,"$apiKey",r);let i=Y([]),f=Y(!1),l=Y(null);async function b(){H(f,!0),H(l,null);try{const n=await fetch(`${ce}?key=${t()}&action=lagersaldo`);if(!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const m=await n.json();H(i,Array.isArray(m.saldo)?m.saldo:[])}catch(n){H(l,n.message)}finally{H(f,!1)}}function k(){const n=prompt("Ange din API-nyckel:");n&&ae.set(n)}Ne(()=>t(),()=>{t()&&b()}),Le(),ke();var h=wa(),K=I(ne(h),2);{var u=n=>{var m=ba(),y=I(ne(m),2);ue("click",y,k),w(n,m)},p=(n,m)=>{{var y=g=>{var c=ka();w(g,c)},E=(g,c)=>{{var s=L=>{var M=Aa(),A=J(M,!0);C(M),W(()=>z(A,o(l))),w(L,M)},_=(L,M)=>{{var A=x=>{var S=xa(),O=J(S),q=J(O);te(q,5,()=>Object.keys(o(i)[0]),re,(F,U)=>{var d=Ia(),T=J(d,!0);C(d),W(()=>z(T,o(U))),w(F,d)}),C(q),C(O);var D=I(O);te(D,5,()=>o(i),re,(F,U)=>{var d=Sa();te(d,5,()=>Object.values(o(U)),re,(T,P)=>{var B=Ea(),le=J(B,!0);C(B),W(()=>z(le,o(P))),w(T,B)}),C(d),w(F,d)}),C(D),C(S),w(x,S)},R=x=>{var S=Ta();w(x,S)};j(L,x=>{Array.isArray(o(i))&&o(i).length>0?x(A):x(R,!1)},M)}};j(g,L=>{o(l)?L(s):L(_,!1)},c)}};j(n,g=>{o(f)?g(y):g(E,!1)},m)}};j(K,n=>{t()?n(p,!1):n(u)})}w(e,h),Me(),v()}var La=N("<option> </option>"),Ma=N("<pre> </pre>"),Oa=N('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ca=N("<p>Laddar material eller saknar API-nyckel...</p>"),Ha=N('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Fa(e,a){we(a,!1);const[r,v]=Ce(),t=()=>He(ae,"$apiKey",r);let i=Y([]),f=Y(null),l=Y({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),b=Y(t()||"");async function k(){try{console.log("Hämtar material med nyckel:",t());const s=await(await fetch(`${ce}?key=${t()}&action=material`)).json();console.log("API-svar material:",s),H(i,Array.isArray(s.material)?s.material:[])}catch(c){console.error("Fel vid hämtning av material:",c),H(i,[])}}function h(){console.log("Sparar API-nyckel:",o(b)),ae.set(o(b)),k()}async function K(){H(f,null);try{console.log("Skickar bokning:",o(l));const s=await(await fetch(`${ce}?key=${t()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(o(l))})).json();console.log("API-svar bokning:",s),H(f,s)}catch(c){console.error("Fel vid bokning:",c),H(f,{error:c.message})}}Ne(()=>t(),()=>{t()&&k()}),Le(),ke();var u=Ha(),p=I(ne(u),2);Q(p);var n=I(p,2),m=I(n,2);{var y=c=>{var s=Oa(),_=ne(s);W(()=>{o(l),sa(()=>{o(i)})});var L=J(_);L.value=L.__value="";var M=I(L);te(M,1,()=>o(i),re,(d,T)=>{var P=La(),B={},le=J(P,!0);C(P),W(()=>{B!==(B=o(T).MaterialId)&&(P.value=(P.__value=o(T).MaterialId)??""),z(le,o(T).Namn)}),w(d,P)}),C(_);var A=I(_,2);Q(A);var R=I(A,2);Q(R);var x=I(R,2);Q(x);var S=I(x,4);Q(S);var O=I(S,2);Q(O);var q=I(O,2);Q(q);var D=I(q,2),F=I(D,2);{var U=d=>{var T=Ma(),P=J(T,!0);C(T),W(B=>z(P,B),[()=>JSON.stringify(o(f),null,2)],Ae),w(d,T)};j(F,d=>{o(f)&&d(U)})}ma(_,()=>o(l).materialId,d=>G(l,o(l).materialId=d)),X(A,()=>o(l).antal,d=>G(l,o(l).antal=d)),X(R,()=>o(l).från,d=>G(l,o(l).från=d)),X(x,()=>o(l).till,d=>G(l,o(l).till=d)),X(S,()=>o(l).ansvarig.namn,d=>G(l,o(l).ansvarig.namn=d)),X(O,()=>o(l).ansvarig.epost,d=>G(l,o(l).ansvarig.epost=d)),X(q,()=>o(l).ansvarig.telefonnummer,d=>G(l,o(l).ansvarig.telefonnummer=d)),ue("click",D,K),w(c,s)},E=c=>{var s=Ca();w(c,s)};j(m,c=>{Array.isArray(o(i))&&o(i).length>0?c(y):c(E,!1)})}var g=I(m,2);Na(g,{}),X(p,()=>o(b),c=>H(b,c)),ue("click",n,h),w(e,u),Me(),v()}export{Fa as component};
