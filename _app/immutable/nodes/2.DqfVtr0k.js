import{t as w,a as N}from"../chunks/Bm9wgCRa.js";import{i as ya}from"../chunks/D3p3htN5.js";import{h as H,a as Ca,b as Ra,q as l,a3 as ka,r as Ha,c as Da,d as da,s as na,e as la,i as j,Z as Ka,f as Aa,g as ba,p as Fa,a1 as Ia,V as Ba,a4 as V,a5 as va,a6 as ia,L as pa,a7 as ca,a8 as ma,a9 as Va,a0 as $a,aa as za,y as Ga,ab as _a,ac as Ja,X as Ua,J as Ya,I as Xa,ad as Sa,R as Wa,ae as Za,af as ja,ag as Qa,ah as ae,ai as ee,k as re,aj as te,ak as Ea,al as ne,am as M,an as le,A as xa,ao as Ta,ap as Na,G as S,z as ta,C as wa,D as B,F as q,B as Z,aq as ie,ar as G}from"../chunks/B2RG6--L.js";import{a as oe,l as La,e as ua,s as Q}from"../chunks/tVZqknJJ.js";import{i as W}from"../chunks/BJQmFdSM.js";function ea(a,e){return e}function se(a,e,t,n){for(var r=[],o=e.length,c=0;c<o;c++)Va(e[c].e,r,!0);var m=o>0&&r.length===0&&t!==null;if(m){var x=t.parentNode;$a(x),x.append(t),n.clear(),F(a,e[0].prev,e[o-1].next)}za(r,()=>{for(var A=0;A<o;A++){var g=e[A];m||(n.delete(g.k),F(a,g.prev,g.next)),Ga(g.e,!m)}})}function ra(a,e,t,n,r,o=null){var c=a,m={flags:e,items:new Map,first:null},x=(e&Sa)!==0;if(x){var A=a;c=H?na(Ya(A)):A.appendChild(Xa())}H&&Ca();var g=null,d=!1,i=ka(()=>{var p=t();return Ba(p)?p:p==null?[]:Ia(p)});Ra(()=>{var p=l(i),s=p.length;if(d&&s===0)return;d=s===0;let b=!1;if(H){var u=Ha(c)===Da;u!==(s===0)&&(c=da(),na(c),la(!1),b=!0)}if(H){for(var h=null,I,y=0;y<s;y++){if(j.nodeType===8&&j.data===Ka){c=j,b=!0,la(!1);break}var v=p[y],f=n(v,y);I=Ma(j,m,h,null,v,f,y,r,e,t),m.items.set(f,I),h=I}s>0&&na(da())}H||ve(p,m,c,r,e,n,t),o!==null&&(s===0?g?Aa(g):g=ba(()=>o(c)):g!==null&&Fa(g,()=>{g=null})),b&&la(!0),l(i)}),H&&(c=j)}function ve(a,e,t,n,r,o,c){var _,T,L,P;var m=(r&Za)!==0,x=(r&(_a|ca))!==0,A=a.length,g=e.items,d=e.first,i=d,p,s=null,b,u=[],h=[],I,y,v,f;if(m)for(f=0;f<A;f+=1)I=a[f],y=o(I,f),v=g.get(y),v!==void 0&&((_=v.a)==null||_.measure(),(b??(b=new Set)).add(v));for(f=0;f<A;f+=1){if(I=a[f],y=o(I,f),v=g.get(y),v===void 0){var $=i?i.e.nodes_start:t;s=Ma($,e,s,s===null?e.first:s.next,I,y,f,n,r,c),g.set(y,s),u=[],h=[],i=s.next;continue}if(x&&ue(v,I,f,r),(v.e.f&ia)!==0&&(Aa(v.e),m&&((T=v.a)==null||T.unfix(),(b??(b=new Set)).delete(v))),v!==i){if(p!==void 0&&p.has(v)){if(u.length<h.length){var E=h[0],k;s=E.prev;var C=u[0],R=u[u.length-1];for(k=0;k<u.length;k+=1)ha(u[k],E,t);for(k=0;k<h.length;k+=1)p.delete(h[k]);F(e,C.prev,R.next),F(e,s,C),F(e,R,E),i=E,s=R,f-=1,u=[],h=[]}else p.delete(v),ha(v,i,t),F(e,v.prev,v.next),F(e,v,s===null?e.first:s.next),F(e,s,v),s=v;continue}for(u=[],h=[];i!==null&&i.k!==y;)(i.e.f&ia)===0&&(p??(p=new Set)).add(i),h.push(i),i=i.next;if(i===null)continue;v=i}u.push(v),s=v,i=v.next}if(i!==null||p!==void 0){for(var O=p===void 0?[]:Ia(p);i!==null;)(i.e.f&ia)===0&&O.push(i),i=i.next;var D=O.length;if(D>0){var z=(r&Sa)!==0&&A===0?t:null;if(m){for(f=0;f<D;f+=1)(L=O[f].a)==null||L.measure();for(f=0;f<D;f+=1)(P=O[f].a)==null||P.fix()}se(e,O,z,g)}}m&&Wa(()=>{var X;if(b!==void 0)for(v of b)(X=v.a)==null||X.apply()}),pa.first=e.first&&e.first.e,pa.last=s&&s.e}function ue(a,e,t,n){(n&_a)!==0&&ma(a.v,e),(n&ca)!==0?ma(a.i,t):a.i=t}function Ma(a,e,t,n,r,o,c,m,x,A){var g=(x&_a)!==0,d=(x&Ja)===0,i=g?d?V(r):va(r):r,p=(x&ca)===0?c:va(c),s={i:p,v:i,k:o,a:null,e:null,prev:t,next:n};try{return s.e=ba(()=>m(a,i,p,A),H),s.e.prev=t&&t.e,s.e.next=n&&n.e,t===null?e.first=s:(t.next=s,t.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function ha(a,e,t){for(var n=a.next?a.next.e.nodes_start:t,r=e?e.e.nodes_start:t,o=a.e.nodes_start;o!==n;){var c=Ua(o);r.before(o),o=c}}function F(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const fe=Symbol("is custom element"),ce=Symbol("is html");function J(a){if(H){var e=!1,t=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var n=a.value;ga(a,"value",null),a.value=n}if(a.hasAttribute("checked")){var r=a.checked;ga(a,"checked",null),a.checked=r}}};a.__on_r=t,ja(t),oe()}}function ga(a,e,t,n){var r=_e(a);H&&(r[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||r[e]!==(r[e]=t)&&(e==="loading"&&(a[Qa]=t),a.removeAttribute(e))}function _e(a){return a.__attributes??(a.__attributes={[fe]:a.nodeName.includes("-"),[ce]:a.namespaceURI===ae})}function U(a,e,t=e){var n=ee();La(a,"input",r=>{var o=r?a.defaultValue:a.value;if(o=oa(a)?sa(o):o,t(o),n&&o!==(o=e())){var c=a.selectionStart,m=a.selectionEnd;a.value=o??"",m!==null&&(a.selectionStart=c,a.selectionEnd=Math.min(m,a.value.length))}}),(H&&a.defaultValue!==a.value||re(e)==null&&a.value)&&t(oa(a)?sa(a.value):a.value),te(()=>{var r=e();oa(a)&&r===sa(a.value)||a.type==="date"&&!r&&!a.value||r!==a.value&&(a.value=r??"")})}function oa(a){var e=a.type;return e==="number"||e==="range"}function sa(a){return a===""?null:+a}function Oa(a,e,t){if(a.multiple)return me(a,e);for(var n of a.options){var r=aa(n);if(ne(r,e)){n.selected=!0;return}}(!t||e!==void 0)&&(a.selectedIndex=-1)}function de(a,e){Ea(()=>{var t=new MutationObserver(()=>{var n=a.__value;Oa(a,n)});return t.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function pe(a,e,t=e){var n=!0;La(a,"change",r=>{var o=r?"[selected]":":checked",c;if(a.multiple)c=[].map.call(a.querySelectorAll(o),aa);else{var m=a.querySelector(o)??a.querySelector("option:not([disabled])");c=m&&aa(m)}t(c)}),Ea(()=>{var r=e();if(Oa(a,r,n),n&&r===void 0){var o=a.querySelector(":checked");o!==null&&(r=aa(o),t(r))}a.__value=r,n=!1}),de(a)}function me(a,e){for(var t of a.options)t.selected=~e.indexOf(aa(t))}function aa(a){return"__value"in a?a.__value:a.value}function Pa(a){var e=va(0);return function(){return arguments.length===1?(M(e,l(e)+1),arguments[0]):(l(e),a())}}const fa="https://script.google.com/macros/s/AKfycbzqo_pcvWWD9L9XG5yEP9Bz33lHKRzA2q5tvS6aGTRoe03z6S3akp1FsN57wOtGYxqy/exec",qa=le({value:localStorage.getItem("api_key")??""});var Y=Pa(()=>qa),he=w("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ge=w("<p>Laddar lagersaldo...</p>"),ye=w('<p style="color: red;"> </p>'),ke=w("<th> </th>"),Ae=w("<td> </td>"),be=w("<tr></tr>"),Ie=w("<table><thead><tr></tr></thead><tbody></tbody></table>"),Se=w("<p>Inget saldo tillgängligt.</p>"),Ee=w("<h2>Lagersaldo</h2> <!>",1);function xe(a,e){xa(e,!1);let t=V([]),n=V(!1),r=V(null);async function o(){M(n,!0),M(r,null);try{console.log("Hämtar lagersaldo med nyckel:",Y().value);const d=await fetch(`${fa}?key=${Y().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",d),!d.ok)throw new Error(`Fel vid hämtning: ${d.status}`);const i=await d.json();console.log("JSON-data från lagersaldo-API:",i),M(t,Array.isArray(i.saldo)?i.saldo:[])}catch(d){console.error("Fel vid hämtning av lagersaldo:",d),M(r,d.message)}finally{M(n,!1)}}function c(){const d=prompt("Ange din API-nyckel:");d&&Y(Y().value=d)}Ta(()=>Y(),()=>{Y().value&&o()}),Na(),ya();var m=Ee(),x=S(ta(m),2);{var A=d=>{var i=he(),p=S(ta(i),2);ua("click",p,c),N(d,i)},g=(d,i)=>{{var p=b=>{var u=ge();N(b,u)},s=(b,u)=>{{var h=y=>{var v=ye(),f=B(v,!0);q(v),Z(()=>Q(f,l(r))),N(y,v)},I=(y,v)=>{{var f=E=>{var k=Ie(),C=B(k),R=B(C);ra(R,5,()=>Object.keys(l(t)[0]),ea,(D,z)=>{var _=ke(),T=B(_,!0);q(_),Z(()=>Q(T,l(z))),N(D,_)}),q(R),q(C);var O=S(C);ra(O,5,()=>l(t),ea,(D,z)=>{var _=be();ra(_,5,()=>Object.values(l(z)),ea,(T,L)=>{var P=Ae(),X=B(P,!0);q(P),Z(()=>Q(X,l(L))),N(T,P)}),q(_),N(D,_)}),q(O),q(k),N(E,k)},$=E=>{var k=Se();N(E,k)};W(y,E=>{Array.isArray(l(t))&&l(t).length>0?E(f):E($,!1)},v)}};W(b,y=>{l(r)?y(h):y(I,!1)},u)}};W(d,b=>{l(n)?b(p):b(s,!1)},i)}};W(x,d=>{Y().value?d(g,!1):d(A)})}N(a,m),wa()}var K=Pa(()=>qa),Te=w("<option> </option>"),Ne=w("<pre> </pre>"),we=w('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Le=w("<p>Laddar material eller saknar API-nyckel...</p>"),Me=w('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function He(a,e){xa(e,!1);let t=V([]),n=V(null),r=V({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),o=V(K().value||"");async function c(){try{console.log("Hämtar material med nyckel:",K().value);const h=await(await fetch(`${fa}?key=${K().value}&action=material`)).json();console.log("API-svar material:",h),M(t,Array.isArray(h.material)?h.material:[])}catch(u){console.error("Fel vid hämtning av material:",u),M(t,[])}}function m(){console.log("Sparar API-nyckel:",l(o)),K(K().value=l(o)),c()}async function x(){M(n,null);try{console.log("Skickar bokning med nyckel:",K().value);const h=await(await fetch(`${fa}?key=${K().value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(l(r))})).json();console.log("API-svar bokning:",h),M(n,h)}catch(u){console.error("Fel vid bokning:",u),M(n,{error:u instanceof Error?u.message:String(u)})}}Ta(()=>K(),()=>{K().value&&c()}),Na(),ya();var A=Me(),g=S(ta(A),2);J(g);var d=S(g,2),i=S(d,2);{var p=u=>{var h=we(),I=ta(h);Z(()=>{l(r),ie(()=>{l(t)})});var y=B(I);y.value=y.__value="";var v=S(y);ra(v,1,()=>l(t),ea,(_,T)=>{var L=Te(),P={},X=B(L,!0);q(L),Z(()=>{P!==(P=l(T).MaterialId)&&(L.value=(L.__value=l(T).MaterialId)??""),Q(X,l(T).Namn)}),N(_,L)}),q(I);var f=S(I,2);J(f);var $=S(f,2);J($);var E=S($,2);J(E);var k=S(E,4);J(k);var C=S(k,2);J(C);var R=S(C,2);J(R);var O=S(R,2),D=S(O,2);{var z=_=>{var T=Ne(),L=B(T);q(T),Z(P=>Q(L,`ban ${P??""} an`),[()=>JSON.stringify(l(n),null,2)],ka),N(_,T)};W(D,_=>{l(n)&&_(z)})}pe(I,()=>l(r).materialId,_=>G(r,l(r).materialId=_)),U(f,()=>l(r).antal,_=>G(r,l(r).antal=_)),U($,()=>l(r).från,_=>G(r,l(r).från=_)),U(E,()=>l(r).till,_=>G(r,l(r).till=_)),U(k,()=>l(r).ansvarig.namn,_=>G(r,l(r).ansvarig.namn=_)),U(C,()=>l(r).ansvarig.epost,_=>G(r,l(r).ansvarig.epost=_)),U(R,()=>l(r).ansvarig.telefonnummer,_=>G(r,l(r).ansvarig.telefonnummer=_)),ua("click",O,x),N(u,h)},s=u=>{var h=Le();N(u,h)};W(i,u=>{Array.isArray(l(t))&&l(t).length>0?u(p):u(s,!1)})}var b=S(i,2);xe(b,{}),U(g,()=>l(o),u=>M(o,u)),ua("click",d,m),N(a,A),wa()}export{He as component};
