import{t as L,a as w}from"../chunks/Bm9wgCRa.js";import{i as ya}from"../chunks/D3p3htN5.js";import{h as q,a as Ha,b as Ra,q as l,a3 as Aa,r as qa,c as Da,d as da,s as na,e as la,i as Q,Z as Ka,f as ka,g as ba,p as Va,a1 as Ia,V as Ba,a4 as F,a5 as va,a6 as ia,L as pa,a7 as ca,a8 as ma,a9 as Fa,a0 as $a,aa as Ja,y as za,ab as _a,ac as Ua,X as Ya,J as Ga,I as Xa,ad as Sa,R as Za,ae as ja,af as Qa,ag as Wa,ah as ae,ai as ee,k as re,aj as te,ak as Ea,al as ne,am as M,an as le,A as xa,ao as Ta,ap as wa,G as S,z as ta,C as La,D as B,F as P,B as j,aq as ie,ar as z}from"../chunks/B2RG6--L.js";import{a as oe,l as Na,e as ua,s as W}from"../chunks/tVZqknJJ.js";import{i as Z}from"../chunks/BJQmFdSM.js";function ea(a,e){return e}function se(a,e,t,n){for(var r=[],o=e.length,c=0;c<o;c++)Fa(e[c].e,r,!0);var m=o>0&&r.length===0&&t!==null;if(m){var x=t.parentNode;$a(x),x.append(t),n.clear(),V(a,e[0].prev,e[o-1].next)}Ja(r,()=>{for(var k=0;k<o;k++){var g=e[k];m||(n.delete(g.k),V(a,g.prev,g.next)),za(g.e,!m)}})}function ra(a,e,t,n,r,o=null){var c=a,m={flags:e,items:new Map,first:null},x=(e&Sa)!==0;if(x){var k=a;c=q?na(Ga(k)):k.appendChild(Xa())}q&&Ha();var g=null,d=!1,i=Aa(()=>{var p=t();return Ba(p)?p:p==null?[]:Ia(p)});Ra(()=>{var p=l(i),s=p.length;if(d&&s===0)return;d=s===0;let b=!1;if(q){var u=qa(c)===Da;u!==(s===0)&&(c=da(),na(c),la(!1),b=!0)}if(q){for(var h=null,I,y=0;y<s;y++){if(Q.nodeType===8&&Q.data===Ka){c=Q,b=!0,la(!1);break}var v=p[y],f=n(v,y);I=Ma(Q,m,h,null,v,f,y,r,e,t),m.items.set(f,I),h=I}s>0&&na(da())}q||ve(p,m,c,r,e,n,t),o!==null&&(s===0?g?ka(g):g=ba(()=>o(c)):g!==null&&Va(g,()=>{g=null})),b&&la(!0),l(i)}),q&&(c=Q)}function ve(a,e,t,n,r,o,c){var _,T,N,C;var m=(r&ja)!==0,x=(r&(_a|ca))!==0,k=a.length,g=e.items,d=e.first,i=d,p,s=null,b,u=[],h=[],I,y,v,f;if(m)for(f=0;f<k;f+=1)I=a[f],y=o(I,f),v=g.get(y),v!==void 0&&((_=v.a)==null||_.measure(),(b??(b=new Set)).add(v));for(f=0;f<k;f+=1){if(I=a[f],y=o(I,f),v=g.get(y),v===void 0){var $=i?i.e.nodes_start:t;s=Ma($,e,s,s===null?e.first:s.next,I,y,f,n,r,c),g.set(y,s),u=[],h=[],i=s.next;continue}if(x&&ue(v,I,f,r),(v.e.f&ia)!==0&&(ka(v.e),m&&((T=v.a)==null||T.unfix(),(b??(b=new Set)).delete(v))),v!==i){if(p!==void 0&&p.has(v)){if(u.length<h.length){var E=h[0],A;s=E.prev;var H=u[0],R=u[u.length-1];for(A=0;A<u.length;A+=1)ha(u[A],E,t);for(A=0;A<h.length;A+=1)p.delete(h[A]);V(e,H.prev,R.next),V(e,s,H),V(e,R,E),i=E,s=R,f-=1,u=[],h=[]}else p.delete(v),ha(v,i,t),V(e,v.prev,v.next),V(e,v,s===null?e.first:s.next),V(e,s,v),s=v;continue}for(u=[],h=[];i!==null&&i.k!==y;)(i.e.f&ia)===0&&(p??(p=new Set)).add(i),h.push(i),i=i.next;if(i===null)continue;v=i}u.push(v),s=v,i=v.next}if(i!==null||p!==void 0){for(var O=p===void 0?[]:Ia(p);i!==null;)(i.e.f&ia)===0&&O.push(i),i=i.next;var D=O.length;if(D>0){var J=(r&Sa)!==0&&k===0?t:null;if(m){for(f=0;f<D;f+=1)(N=O[f].a)==null||N.measure();for(f=0;f<D;f+=1)(C=O[f].a)==null||C.fix()}se(e,O,J,g)}}m&&Za(()=>{var X;if(b!==void 0)for(v of b)(X=v.a)==null||X.apply()}),pa.first=e.first&&e.first.e,pa.last=s&&s.e}function ue(a,e,t,n){(n&_a)!==0&&ma(a.v,e),(n&ca)!==0?ma(a.i,t):a.i=t}function Ma(a,e,t,n,r,o,c,m,x,k){var g=(x&_a)!==0,d=(x&Ua)===0,i=g?d?F(r):va(r):r,p=(x&ca)===0?c:va(c),s={i:p,v:i,k:o,a:null,e:null,prev:t,next:n};try{return s.e=ba(()=>m(a,i,p,k),q),s.e.prev=t&&t.e,s.e.next=n&&n.e,t===null?e.first=s:(t.next=s,t.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function ha(a,e,t){for(var n=a.next?a.next.e.nodes_start:t,r=e?e.e.nodes_start:t,o=a.e.nodes_start;o!==n;){var c=Ya(o);r.before(o),o=c}}function V(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const fe=Symbol("is custom element"),ce=Symbol("is html");function U(a){if(q){var e=!1,t=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var n=a.value;ga(a,"value",null),a.value=n}if(a.hasAttribute("checked")){var r=a.checked;ga(a,"checked",null),a.checked=r}}};a.__on_r=t,Qa(t),oe()}}function ga(a,e,t,n){var r=_e(a);q&&(r[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||r[e]!==(r[e]=t)&&(e==="loading"&&(a[Wa]=t),a.removeAttribute(e))}function _e(a){return a.__attributes??(a.__attributes={[fe]:a.nodeName.includes("-"),[ce]:a.namespaceURI===ae})}function Y(a,e,t=e){var n=ee();Na(a,"input",r=>{var o=r?a.defaultValue:a.value;if(o=oa(a)?sa(o):o,t(o),n&&o!==(o=e())){var c=a.selectionStart,m=a.selectionEnd;a.value=o??"",m!==null&&(a.selectionStart=c,a.selectionEnd=Math.min(m,a.value.length))}}),(q&&a.defaultValue!==a.value||re(e)==null&&a.value)&&t(oa(a)?sa(a.value):a.value),te(()=>{var r=e();oa(a)&&r===sa(a.value)||a.type==="date"&&!r&&!a.value||r!==a.value&&(a.value=r??"")})}function oa(a){var e=a.type;return e==="number"||e==="range"}function sa(a){return a===""?null:+a}function Oa(a,e,t){if(a.multiple)return me(a,e);for(var n of a.options){var r=aa(n);if(ne(r,e)){n.selected=!0;return}}(!t||e!==void 0)&&(a.selectedIndex=-1)}function de(a,e){Ea(()=>{var t=new MutationObserver(()=>{var n=a.__value;Oa(a,n)});return t.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function pe(a,e,t=e){var n=!0;Na(a,"change",r=>{var o=r?"[selected]":":checked",c;if(a.multiple)c=[].map.call(a.querySelectorAll(o),aa);else{var m=a.querySelector(o)??a.querySelector("option:not([disabled])");c=m&&aa(m)}t(c)}),Ea(()=>{var r=e();if(Oa(a,r,n),n&&r===void 0){var o=a.querySelector(":checked");o!==null&&(r=aa(o),t(r))}a.__value=r,n=!1}),de(a)}function me(a,e){for(var t of a.options)t.selected=~e.indexOf(aa(t))}function aa(a){return"__value"in a?a.__value:a.value}function Ca(a){var e=va(0);return function(){return arguments.length===1?(M(e,l(e)+1),arguments[0]):(l(e),a())}}const fa="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",Pa=le({value:localStorage.getItem("api_key")??""});var G=Ca(()=>Pa),he=L("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ge=L("<p>Laddar lagersaldo...</p>"),ye=L('<p style="color: red;"> </p>'),Ae=L("<th> </th>"),ke=L("<td> </td>"),be=L("<tr></tr>"),Ie=L("<table><thead><tr></tr></thead><tbody></tbody></table>"),Se=L("<p>Inget saldo tillgängligt.</p>"),Ee=L("<h2>Lagersaldo</h2> <!>",1);function xe(a,e){xa(e,!1);let t=F([]),n=F(!1),r=F(null);async function o(){M(n,!0),M(r,null);try{console.log("Hämtar lagersaldo med nyckel:",G().value);const d=await fetch(`${fa}?key=${G().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",d),!d.ok)throw new Error(`Fel vid hämtning: ${d.status}`);const i=await d.json();console.log("JSON-data från lagersaldo-API:",i),M(t,Array.isArray(i.saldo)?i.saldo:[])}catch(d){console.error("Fel vid hämtning av lagersaldo:",d),M(r,d.message)}finally{M(n,!1)}}function c(){const d=prompt("Ange din API-nyckel:");d&&G(G().value=d)}Ta(()=>G(),()=>{G().value&&o()}),wa(),ya();var m=Ee(),x=S(ta(m),2);{var k=d=>{var i=he(),p=S(ta(i),2);ua("click",p,c),w(d,i)},g=(d,i)=>{{var p=b=>{var u=ge();w(b,u)},s=(b,u)=>{{var h=y=>{var v=ye(),f=B(v,!0);P(v),j(()=>W(f,l(r))),w(y,v)},I=(y,v)=>{{var f=E=>{var A=Ie(),H=B(A),R=B(H);ra(R,5,()=>Object.keys(l(t)[0]),ea,(D,J)=>{var _=Ae(),T=B(_,!0);P(_),j(()=>W(T,l(J))),w(D,_)}),P(R),P(H);var O=S(H);ra(O,5,()=>l(t),ea,(D,J)=>{var _=be();ra(_,5,()=>Object.values(l(J)),ea,(T,N)=>{var C=ke(),X=B(C,!0);P(C),j(()=>W(X,l(N))),w(T,C)}),P(_),w(D,_)}),P(O),P(A),w(E,A)},$=E=>{var A=Se();w(E,A)};Z(y,E=>{Array.isArray(l(t))&&l(t).length>0?E(f):E($,!1)},v)}};Z(b,y=>{l(r)?y(h):y(I,!1)},u)}};Z(d,b=>{l(n)?b(p):b(s,!1)},i)}};Z(x,d=>{G().value?d(g,!1):d(k)})}w(a,m),La()}var K=Ca(()=>Pa),Te=L("<option> </option>"),we=L("<pre> </pre>"),Le=L('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ne=L("<p>Laddar material eller saknar API-nyckel...</p>"),Me=L('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function qe(a,e){xa(e,!1);let t=F([]),n=F(null),r=F({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),o=F(K().value||"");async function c(){try{console.log("Hämtar material med nyckel:",K().value);const h=await(await fetch(`${fa}?key=${K().value}&action=material`)).json();console.log("API-svar material:",h),M(t,Array.isArray(h.material)?h.material:[])}catch(u){console.error("Fel vid hämtning av material:",u),M(t,[])}}function m(){console.log("Sparar API-nyckel:",l(o)),K(K().value=l(o)),c()}async function x(){M(n,null);try{console.log("Skickar bokning med nyckel:",K().value);const h=await(await fetch(`${fa}?key=${K().value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(l(r))})).json();console.log("API-svar bokning:",h),M(n,h)}catch(u){console.error("Fel vid bokning:",u),M(n,{error:u instanceof Error?u.message:String(u)})}}Ta(()=>K(),()=>{K().value&&c()}),wa(),ya();var k=Me(),g=S(ta(k),2);U(g);var d=S(g,2),i=S(d,2);{var p=u=>{var h=Le(),I=ta(h);j(()=>{l(r),ie(()=>{l(t)})});var y=B(I);y.value=y.__value="";var v=S(y);ra(v,1,()=>l(t),ea,(_,T)=>{var N=Te(),C={},X=B(N,!0);P(N),j(()=>{C!==(C=l(T).MaterialId)&&(N.value=(N.__value=l(T).MaterialId)??""),W(X,l(T).Namn)}),w(_,N)}),P(I);var f=S(I,2);U(f);var $=S(f,2);U($);var E=S($,2);U(E);var A=S(E,4);U(A);var H=S(A,2);U(H);var R=S(H,2);U(R);var O=S(R,2),D=S(O,2);{var J=_=>{var T=we(),N=B(T);P(T),j(C=>W(N,`ban ${C??""} an`),[()=>JSON.stringify(l(n),null,2)],Aa),w(_,T)};Z(D,_=>{l(n)&&_(J)})}pe(I,()=>l(r).materialId,_=>z(r,l(r).materialId=_)),Y(f,()=>l(r).antal,_=>z(r,l(r).antal=_)),Y($,()=>l(r).från,_=>z(r,l(r).från=_)),Y(E,()=>l(r).till,_=>z(r,l(r).till=_)),Y(A,()=>l(r).ansvarig.namn,_=>z(r,l(r).ansvarig.namn=_)),Y(H,()=>l(r).ansvarig.epost,_=>z(r,l(r).ansvarig.epost=_)),Y(R,()=>l(r).ansvarig.telefonnummer,_=>z(r,l(r).ansvarig.telefonnummer=_)),ua("click",O,x),w(u,h)},s=u=>{var h=Ne();w(u,h)};Z(i,u=>{Array.isArray(l(t))&&l(t).length>0?u(p):u(s,!1)})}var b=S(i,2);xe(b,{}),Y(g,()=>l(o),u=>M(o,u)),ua("click",d,m),w(a,k),La()}export{qe as component};
