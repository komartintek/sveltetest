import{t as M,a as T}from"../chunks/CNputRQq.js";import{R as be,ao as Ce,ap as Oe,h as H,a as Pe,b as He,q as _,a9 as Re,r as qe,c as De,d as pe,s as le,e as ie,i as $,Z as Be,f as ke,g as Ie,p as Fe,a1 as Se,ae as W,aq as ue,ar as se,L as ge,as as ce,at as he,au as Ve,a0 as Je,av as Ke,y as ze,aw as _e,ax as Ge,X as Ue,J as Ye,I as $e,ay as Ee,V as je,az as Xe,aA as Ze,aB as Qe,aC as We,aD as ea,k as aa,a4 as ra,a3 as we,aE as ta,ad as N,ac as de,A as xe,aF as na,aG as la,G as w,z as te,C as Le,D as V,F as C,B as j,al as ve,u as ia,an as sa}from"../chunks/Bul_6VOG.js";import{a as oa,l as Te,e as fa,s as X,d as ua}from"../chunks/D8gnIKhX.js";import{i as Y}from"../chunks/lkCOugSH.js";import{i as va}from"../chunks/CdnbHVUu.js";const ca=[];function _a(e,a=!1){return ee(e,new Map,"",ca)}function ee(e,a,r,n,t=null){if(typeof e=="object"&&e!==null){var l=a.get(e);if(l!==void 0)return l;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(be(e)){var i=Array(e.length);a.set(e,i),t!==null&&a.set(t,i);for(var v=0;v<e.length;v+=1){var S=e[v];v in e&&(i[v]=ee(S,a,r,n))}return i}if(Ce(e)===Oe){i={},a.set(e,i),t!==null&&a.set(t,i);for(var A in e)i[A]=ee(e[A],a,r,n);return i}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return ee(e.toJSON(),a,r,n,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function ae(e,a){return a}function da(e,a,r,n){for(var t=[],l=a.length,i=0;i<l;i++)Ve(a[i].e,t,!0);var v=l>0&&t.length===0&&r!==null;if(v){var S=r.parentNode;Je(S),S.append(r),n.clear(),F(e,a[0].prev,a[l-1].next)}Ke(t,()=>{for(var A=0;A<l;A++){var g=a[A];v||(n.delete(g.k),F(e,g.prev,g.next)),ze(g.e,!v)}})}function re(e,a,r,n,t,l=null){var i=e,v={flags:a,items:new Map,first:null},S=(a&Ee)!==0;if(S){var A=e;i=H?le(Ye(A)):A.appendChild($e())}H&&Pe();var g=null,d=!1,s=Re(()=>{var m=r();return be(m)?m:m==null?[]:Se(m)});He(()=>{var m=_(s),f=m.length;if(d&&f===0)return;d=f===0;let c=!1;if(H){var h=qe(i)===De;h!==(f===0)&&(i=pe(),le(i),ie(!1),c=!0)}if(H){for(var b=null,E,y=0;y<f;y++){if($.nodeType===8&&$.data===Be){i=$,c=!0,ie(!1);break}var o=m[y],u=n(o,y);E=Me($,v,b,null,o,u,y,t,a,r),v.items.set(u,E),b=E}f>0&&le(pe())}H||ma(m,v,i,t,a,n,r),l!==null&&(f===0?g?ke(g):g=Ie(()=>l(i)):g!==null&&Fe(g,()=>{g=null})),c&&ie(!0),_(s)}),H&&(i=$)}function ma(e,a,r,n,t,l,i){var I,L,D,B;var v=(t&Xe)!==0,S=(t&(_e|ce))!==0,A=e.length,g=a.items,d=a.first,s=d,m,f=null,c,h=[],b=[],E,y,o,u;if(v)for(u=0;u<A;u+=1)E=e[u],y=l(E,u),o=g.get(y),o!==void 0&&((I=o.a)==null||I.measure(),(c??(c=new Set)).add(o));for(u=0;u<A;u+=1){if(E=e[u],y=l(E,u),o=g.get(y),o===void 0){var J=s?s.e.nodes_start:r;f=Me(J,a,f,f===null?a.first:f.next,E,y,u,n,t,i),g.set(y,f),h=[],b=[],s=f.next;continue}if(S&&pa(o,E,u,t),(o.e.f&se)!==0&&(ke(o.e),v&&((L=o.a)==null||L.unfix(),(c??(c=new Set)).delete(o))),o!==s){if(m!==void 0&&m.has(o)){if(h.length<b.length){var x=b[0],k;f=x.prev;var O=h[0],R=h[h.length-1];for(k=0;k<h.length;k+=1)ye(h[k],x,r);for(k=0;k<b.length;k+=1)m.delete(b[k]);F(a,O.prev,R.next),F(a,f,O),F(a,R,x),s=x,f=R,u-=1,h=[],b=[]}else m.delete(o),ye(o,s,r),F(a,o.prev,o.next),F(a,o,f===null?a.first:f.next),F(a,f,o),f=o;continue}for(h=[],b=[];s!==null&&s.k!==y;)(s.e.f&se)===0&&(m??(m=new Set)).add(s),b.push(s),s=s.next;if(s===null)continue;o=s}h.push(o),f=o,s=o.next}if(s!==null||m!==void 0){for(var P=m===void 0?[]:Se(m);s!==null;)(s.e.f&se)===0&&P.push(s),s=s.next;var q=P.length;if(q>0){var p=(t&Ee)!==0&&A===0?r:null;if(v){for(u=0;u<q;u+=1)(D=P[u].a)==null||D.measure();for(u=0;u<q;u+=1)(B=P[u].a)==null||B.fix()}da(a,P,p,g)}}v&&je(()=>{var Q;if(c!==void 0)for(o of c)(Q=o.a)==null||Q.apply()}),ge.first=a.first&&a.first.e,ge.last=f&&f.e}function pa(e,a,r,n){(n&_e)!==0&&he(e.v,a),(n&ce)!==0?he(e.i,r):e.i=r}function Me(e,a,r,n,t,l,i,v,S,A){var g=(S&_e)!==0,d=(S&Ge)===0,s=g?d?W(t):ue(t):t,m=(S&ce)===0?i:ue(i),f={i:m,v:s,k:l,a:null,e:null,prev:r,next:n};try{return f.e=Ie(()=>v(e,s,m,A),H),f.e.prev=r&&r.e,f.e.next=n&&n.e,r===null?a.first=f:(r.next=f,r.e.next=f.e),n!==null&&(n.prev=f,n.e.prev=f.e),f}finally{}}function ye(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,l=e.e.nodes_start;l!==n;){var i=Ue(l);t.before(l),l=i}}function F(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const ga=Symbol("is custom element"),ha=Symbol("is html");function K(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;Ae(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var t=e.checked;Ae(e,"checked",null),e.checked=t}}};e.__on_r=r,Ze(r),oa()}}function Ae(e,a,r,n){var t=ya(e);H&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[Qe]=r),e.removeAttribute(a))}function ya(e){return e.__attributes??(e.__attributes={[ga]:e.nodeName.includes("-"),[ha]:e.namespaceURI===We})}function z(e,a,r=a){var n=ea();Te(e,"input",t=>{var l=t?e.defaultValue:e.value;if(l=oe(e)?fe(l):l,r(l),n&&l!==(l=a())){var i=e.selectionStart,v=e.selectionEnd;e.value=l??"",v!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(v,e.value.length))}}),(H&&e.defaultValue!==e.value||aa(a)==null&&e.value)&&r(oe(e)?fe(e.value):e.value),ra(()=>{var t=a();oe(e)&&t===fe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function oe(e){var a=e.type;return a==="number"||a==="range"}function fe(e){return e===""?null:+e}function Ne(e,a,r){if(e.multiple)return ka(e,a);for(var n of e.options){var t=Z(n);if(ta(t,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function Aa(e,a){we(()=>{var r=new MutationObserver(()=>{var n=e.__value;Ne(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ba(e,a,r=a){var n=!0;Te(e,"change",t=>{var l=t?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(l),Z);else{var v=e.querySelector(l)??e.querySelector("option:not([disabled])");i=v&&Z(v)}r(i)}),we(()=>{var t=a();if(Ne(e,t,n),n&&t===void 0){var l=e.querySelector(":checked");l!==null&&(t=Z(l),r(t))}e.__value=t,n=!1}),Aa(e)}function ka(e,a){for(var r of e.options)r.selected=~a.indexOf(Z(r))}function Z(e){return"__value"in e?e.__value:e.value}function Ia(e){var a=ue(0);return function(){return arguments.length===1?(N(a,_(a)+1),arguments[0]):(_(a),e())}}const me="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",U=de({value:localStorage.getItem("api_key")??""});var G=Ia(()=>U),Sa=M("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Ea=M("<p>Laddar lagersaldo...</p>"),wa=M('<p style="color: red;"> </p>'),xa=M("<th> </th>"),La=M("<td> </td>"),Ta=M("<tr></tr>"),Ma=M("<table><thead><tr></tr></thead><tbody></tbody></table>"),Na=M("<p>Inget saldo tillgängligt.</p>"),Ca=M("<h2>Lagersaldo</h2> <!>",1);function Oa(e,a){xe(a,!1);let r=W([]),n=W(!1),t=W(null);async function l(){N(n,!0),N(t,null);try{console.log("Hämtar lagersaldo med nyckel:",G().value);const d=await fetch(`${me}?key=${G().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",d),!d.ok)throw new Error(`Fel vid hämtning: ${d.status}`);const s=await d.json();console.log("JSON-data från lagersaldo-API:",s),N(r,Array.isArray(s.saldo)?s.saldo:[])}catch(d){console.error("Fel vid hämtning av lagersaldo:",d),N(t,d.message)}finally{N(n,!1)}}function i(){const d=prompt("Ange din API-nyckel:");d&&G(G().value=d)}na(()=>G(),()=>{G().value&&l()}),la(),va();var v=Ca(),S=w(te(v),2);{var A=d=>{var s=Sa(),m=w(te(s),2);fa("click",m,i),T(d,s)},g=(d,s)=>{{var m=c=>{var h=Ea();T(c,h)},f=(c,h)=>{{var b=y=>{var o=wa(),u=V(o,!0);C(o),j(()=>X(u,_(t))),T(y,o)},E=(y,o)=>{{var u=x=>{var k=Ma(),O=V(k),R=V(O);re(R,5,()=>Object.keys(_(r)[0]),ae,(q,p)=>{var I=xa(),L=V(I,!0);C(I),j(()=>X(L,_(p))),T(q,I)}),C(R),C(O);var P=w(O);re(P,5,()=>_(r),ae,(q,p)=>{var I=Ta();re(I,5,()=>Object.values(_(p)),ae,(L,D)=>{var B=La(),Q=V(B,!0);C(B),j(()=>X(Q,_(D))),T(L,B)}),C(I),T(q,I)}),C(P),C(k),T(x,k)},J=x=>{var k=Na();T(x,k)};Y(y,x=>{Array.isArray(_(r))&&_(r).length>0?x(u):x(J,!1)},o)}};Y(c,y=>{_(t)?y(b):y(E,!1)},h)}};Y(d,c=>{_(n)?c(m):c(f,!1)},s)}};Y(S,d=>{G().value?d(g,!1):d(A)})}T(e,v),Le()}let ne=ve(de([])),Pa={getMaterialList:()=>(_(ne).length===0&&Ha(),_(ne))};async function Ha(){try{console.log("Hämtar material med nyckel:",U.value);const a=await(await fetch(`${me}?key=${U.value}&action=material`)).json();console.log("API-svar material:",a),N(ne,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(ne,[],!0)}}var Ra=M("<option> </option>"),qa=M("<pre> </pre>"),Da=M('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ba=M("<p>Laddar material eller saknar API-nyckel...</p>"),Fa=M('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Ua(e,a){xe(a,!0);let r=sa(()=>Pa.getMaterialList()),n=ve(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},l=ve(de(U.value||""));ia(()=>{console.log(_a(_(r)))});function i(){console.log("Sparar API-nyckel:",_(l)),U.value=_(l)}async function v(){N(n,null);try{console.log("Skickar bokning med nyckel:",U.value);const h=await(await fetch(`${me}?key=${U.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",h),N(n,h,!0)}catch(c){console.error("Fel vid bokning:",c),N(n,{error:c instanceof Error?c.message:String(c)},!0)}}var S=Fa(),A=w(te(S),2);K(A);var g=w(A,2);g.__click=i;var d=w(g,2);{var s=c=>{var h=Da(),b=te(h),E=V(b);E.value=E.__value="";var y=w(E);re(y,17,()=>_(r),ae,(p,I)=>{var L=Ra(),D={},B=V(L,!0);C(L),j(()=>{D!==(D=_(I).MaterialId)&&(L.value=(L.__value=_(I).MaterialId)??""),X(B,_(I).Namn)}),T(p,L)}),C(b);var o=w(b,2);K(o);var u=w(o,2);K(u);var J=w(u,2);K(J);var x=w(J,4);K(x);var k=w(x,2);K(k);var O=w(k,2);K(O);var R=w(O,2);R.__click=v;var P=w(R,2);{var q=p=>{var I=qa(),L=V(I);C(I),j(D=>X(L,`ban ${D??""} an`),[()=>JSON.stringify(_(n),null,2)]),T(p,I)};Y(P,p=>{_(n)&&p(q)})}ba(b,()=>t.materialId,p=>t.materialId=p),z(o,()=>t.antal,p=>t.antal=p),z(u,()=>t.från,p=>t.från=p),z(J,()=>t.till,p=>t.till=p),z(x,()=>t.ansvarig.namn,p=>t.ansvarig.namn=p),z(k,()=>t.ansvarig.epost,p=>t.ansvarig.epost=p),z(O,()=>t.ansvarig.telefonnummer,p=>t.ansvarig.telefonnummer=p),T(c,h)},m=c=>{var h=Ba();T(c,h)};Y(d,c=>{Array.isArray(_(r))&&_(r).length>0?c(s):c(m,!1)})}var f=w(d,2);Oa(f,{}),z(A,()=>_(l),c=>N(l,c)),T(e,S),Le()}ua(["click"]);export{Ua as component};
