import{t as M,a as T}from"../chunks/CNputRQq.js";import{R as be,ao as Ce,ap as Oe,h as H,a as Pe,b as He,q as p,a9 as Re,r as qe,c as De,d as pe,s as ie,e as se,i as $,Z as Be,f as ke,g as Ie,p as Fe,a1 as Se,ae as ee,aq as ve,ar as oe,L as ge,as as _e,at as he,au as Ve,a0 as Je,av as Ke,y as ze,aw as de,ax as Ge,X as Ue,J as Ye,I as $e,ay as Ee,V as je,az as Xe,aA as Ze,aB as Qe,aC as We,aD as ea,k as aa,a4 as ra,a3 as we,aE as ta,ad as N,ac as ne,A as xe,aF as na,aG as la,G as w,z as le,C as Le,D as V,F as C,B as j,al as ce}from"../chunks/Bul_6VOG.js";import{a as ia,l as Te,e as sa,s as X,d as oa}from"../chunks/D8gnIKhX.js";import{i as Y}from"../chunks/lkCOugSH.js";import{i as fa}from"../chunks/CdnbHVUu.js";const ua=[];function va(e,a=!1){return ae(e,new Map,"",ua)}function ae(e,a,r,n,t=null){if(typeof e=="object"&&e!==null){var l=a.get(e);if(l!==void 0)return l;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(be(e)){var i=Array(e.length);a.set(e,i),t!==null&&a.set(t,i);for(var v=0;v<e.length;v+=1){var S=e[v];v in e&&(i[v]=ae(S,a,r,n))}return i}if(Ce(e)===Oe){i={},a.set(e,i),t!==null&&a.set(t,i);for(var A in e)i[A]=ae(e[A],a,r,n);return i}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return ae(e.toJSON(),a,r,n,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function re(e,a){return a}function ca(e,a,r,n){for(var t=[],l=a.length,i=0;i<l;i++)Ve(a[i].e,t,!0);var v=l>0&&t.length===0&&r!==null;if(v){var S=r.parentNode;Je(S),S.append(r),n.clear(),F(e,a[0].prev,a[l-1].next)}Ke(t,()=>{for(var A=0;A<l;A++){var g=a[A];v||(n.delete(g.k),F(e,g.prev,g.next)),ze(g.e,!v)}})}function te(e,a,r,n,t,l=null){var i=e,v={flags:a,items:new Map,first:null},S=(a&Ee)!==0;if(S){var A=e;i=H?ie(Ye(A)):A.appendChild($e())}H&&Pe();var g=null,_=!1,s=Re(()=>{var d=r();return be(d)?d:d==null?[]:Se(d)});He(()=>{var d=p(s),f=d.length;if(_&&f===0)return;_=f===0;let c=!1;if(H){var h=qe(i)===De;h!==(f===0)&&(i=pe(),ie(i),se(!1),c=!0)}if(H){for(var b=null,E,y=0;y<f;y++){if($.nodeType===8&&$.data===Be){i=$,c=!0,se(!1);break}var o=d[y],u=n(o,y);E=Me($,v,b,null,o,u,y,t,a,r),v.items.set(u,E),b=E}f>0&&ie(pe())}H||_a(d,v,i,t,a,n,r),l!==null&&(f===0?g?ke(g):g=Ie(()=>l(i)):g!==null&&Fe(g,()=>{g=null})),c&&se(!0),p(s)}),H&&(i=$)}function _a(e,a,r,n,t,l,i){var I,L,D,B;var v=(t&Xe)!==0,S=(t&(de|_e))!==0,A=e.length,g=a.items,_=a.first,s=_,d,f=null,c,h=[],b=[],E,y,o,u;if(v)for(u=0;u<A;u+=1)E=e[u],y=l(E,u),o=g.get(y),o!==void 0&&((I=o.a)==null||I.measure(),(c??(c=new Set)).add(o));for(u=0;u<A;u+=1){if(E=e[u],y=l(E,u),o=g.get(y),o===void 0){var J=s?s.e.nodes_start:r;f=Me(J,a,f,f===null?a.first:f.next,E,y,u,n,t,i),g.set(y,f),h=[],b=[],s=f.next;continue}if(S&&da(o,E,u,t),(o.e.f&oe)!==0&&(ke(o.e),v&&((L=o.a)==null||L.unfix(),(c??(c=new Set)).delete(o))),o!==s){if(d!==void 0&&d.has(o)){if(h.length<b.length){var x=b[0],k;f=x.prev;var O=h[0],R=h[h.length-1];for(k=0;k<h.length;k+=1)ye(h[k],x,r);for(k=0;k<b.length;k+=1)d.delete(b[k]);F(a,O.prev,R.next),F(a,f,O),F(a,R,x),s=x,f=R,u-=1,h=[],b=[]}else d.delete(o),ye(o,s,r),F(a,o.prev,o.next),F(a,o,f===null?a.first:f.next),F(a,f,o),f=o;continue}for(h=[],b=[];s!==null&&s.k!==y;)(s.e.f&oe)===0&&(d??(d=new Set)).add(s),b.push(s),s=s.next;if(s===null)continue;o=s}h.push(o),f=o,s=o.next}if(s!==null||d!==void 0){for(var P=d===void 0?[]:Se(d);s!==null;)(s.e.f&oe)===0&&P.push(s),s=s.next;var q=P.length;if(q>0){var m=(t&Ee)!==0&&A===0?r:null;if(v){for(u=0;u<q;u+=1)(D=P[u].a)==null||D.measure();for(u=0;u<q;u+=1)(B=P[u].a)==null||B.fix()}ca(a,P,m,g)}}v&&je(()=>{var W;if(c!==void 0)for(o of c)(W=o.a)==null||W.apply()}),ge.first=a.first&&a.first.e,ge.last=f&&f.e}function da(e,a,r,n){(n&de)!==0&&he(e.v,a),(n&_e)!==0?he(e.i,r):e.i=r}function Me(e,a,r,n,t,l,i,v,S,A){var g=(S&de)!==0,_=(S&Ge)===0,s=g?_?ee(t):ve(t):t,d=(S&_e)===0?i:ve(i),f={i:d,v:s,k:l,a:null,e:null,prev:r,next:n};try{return f.e=Ie(()=>v(e,s,d,A),H),f.e.prev=r&&r.e,f.e.next=n&&n.e,r===null?a.first=f:(r.next=f,r.e.next=f.e),n!==null&&(n.prev=f,n.e.prev=f.e),f}finally{}}function ye(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,l=e.e.nodes_start;l!==n;){var i=Ue(l);t.before(l),l=i}}function F(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const ma=Symbol("is custom element"),pa=Symbol("is html");function K(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;Ae(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var t=e.checked;Ae(e,"checked",null),e.checked=t}}};e.__on_r=r,Ze(r),ia()}}function Ae(e,a,r,n){var t=ga(e);H&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[Qe]=r),e.removeAttribute(a))}function ga(e){return e.__attributes??(e.__attributes={[ma]:e.nodeName.includes("-"),[pa]:e.namespaceURI===We})}function z(e,a,r=a){var n=ea();Te(e,"input",t=>{var l=t?e.defaultValue:e.value;if(l=fe(e)?ue(l):l,r(l),n&&l!==(l=a())){var i=e.selectionStart,v=e.selectionEnd;e.value=l??"",v!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(v,e.value.length))}}),(H&&e.defaultValue!==e.value||aa(a)==null&&e.value)&&r(fe(e)?ue(e.value):e.value),ra(()=>{var t=a();fe(e)&&t===ue(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function fe(e){var a=e.type;return a==="number"||a==="range"}function ue(e){return e===""?null:+e}function Ne(e,a,r){if(e.multiple)return Aa(e,a);for(var n of e.options){var t=Z(n);if(ta(t,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ha(e,a){we(()=>{var r=new MutationObserver(()=>{var n=e.__value;Ne(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ya(e,a,r=a){var n=!0;Te(e,"change",t=>{var l=t?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(l),Z);else{var v=e.querySelector(l)??e.querySelector("option:not([disabled])");i=v&&Z(v)}r(i)}),we(()=>{var t=a();if(Ne(e,t,n),n&&t===void 0){var l=e.querySelector(":checked");l!==null&&(t=Z(l),r(t))}e.__value=t,n=!1}),ha(e)}function Aa(e,a){for(var r of e.options)r.selected=~a.indexOf(Z(r))}function Z(e){return"__value"in e?e.__value:e.value}function ba(e){var a=ve(0);return function(){return arguments.length===1?(N(a,p(a)+1),arguments[0]):(p(a),e())}}const me="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",U=ne({value:localStorage.getItem("api_key")??""});var G=ba(()=>U),ka=M("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Ia=M("<p>Laddar lagersaldo...</p>"),Sa=M('<p style="color: red;"> </p>'),Ea=M("<th> </th>"),wa=M("<td> </td>"),xa=M("<tr></tr>"),La=M("<table><thead><tr></tr></thead><tbody></tbody></table>"),Ta=M("<p>Inget saldo tillgängligt.</p>"),Ma=M("<h2>Lagersaldo</h2> <!>",1);function Na(e,a){xe(a,!1);let r=ee([]),n=ee(!1),t=ee(null);async function l(){N(n,!0),N(t,null);try{console.log("Hämtar lagersaldo med nyckel:",G().value);const _=await fetch(`${me}?key=${G().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",_),!_.ok)throw new Error(`Fel vid hämtning: ${_.status}`);const s=await _.json();console.log("JSON-data från lagersaldo-API:",s),N(r,Array.isArray(s.saldo)?s.saldo:[])}catch(_){console.error("Fel vid hämtning av lagersaldo:",_),N(t,_.message)}finally{N(n,!1)}}function i(){const _=prompt("Ange din API-nyckel:");_&&G(G().value=_)}na(()=>G(),()=>{G().value&&l()}),la(),fa();var v=Ma(),S=w(le(v),2);{var A=_=>{var s=ka(),d=w(le(s),2);sa("click",d,i),T(_,s)},g=(_,s)=>{{var d=c=>{var h=Ia();T(c,h)},f=(c,h)=>{{var b=y=>{var o=Sa(),u=V(o,!0);C(o),j(()=>X(u,p(t))),T(y,o)},E=(y,o)=>{{var u=x=>{var k=La(),O=V(k),R=V(O);te(R,5,()=>Object.keys(p(r)[0]),re,(q,m)=>{var I=Ea(),L=V(I,!0);C(I),j(()=>X(L,p(m))),T(q,I)}),C(R),C(O);var P=w(O);te(P,5,()=>p(r),re,(q,m)=>{var I=xa();te(I,5,()=>Object.values(p(m)),re,(L,D)=>{var B=wa(),W=V(B,!0);C(B),j(()=>X(W,p(D))),T(L,B)}),C(I),T(q,I)}),C(P),C(k),T(x,k)},J=x=>{var k=Ta();T(x,k)};Y(y,x=>{Array.isArray(p(r))&&p(r).length>0?x(u):x(J,!1)},o)}};Y(c,y=>{p(t)?y(b):y(E,!1)},h)}};Y(_,c=>{p(n)?c(d):c(f,!1)},s)}};Y(S,_=>{G().value?_(g,!1):_(A)})}T(e,v),Le()}let Q=ce(ne([])),Ca={getMaterialList:()=>(p(Q).length===0&&Oa(),console.log(va(p(Q))),p(Q))};async function Oa(){try{console.log("Hämtar material med nyckel:",U.value);const a=await(await fetch(`${me}?key=${U.value}&action=material`)).json();console.log("API-svar material:",a),N(Q,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(Q,[],!0)}}var Pa=M("<option> </option>"),Ha=M("<pre> </pre>"),Ra=M('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),qa=M("<p>Laddar material eller saknar API-nyckel...</p>"),Da=M('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function za(e,a){xe(a,!0);let r=ne(Ca.getMaterialList()),n=ce(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},l=ce(ne(U.value||""));function i(){console.log("Sparar API-nyckel:",p(l)),U.value=p(l)}async function v(){N(n,null);try{console.log("Skickar bokning med nyckel:",U.value);const h=await(await fetch(`${me}?key=${U.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",h),N(n,h,!0)}catch(c){console.error("Fel vid bokning:",c),N(n,{error:c instanceof Error?c.message:String(c)},!0)}}var S=Da(),A=w(le(S),2);K(A);var g=w(A,2);g.__click=i;var _=w(g,2);{var s=c=>{var h=Ra(),b=le(h),E=V(b);E.value=E.__value="";var y=w(E);te(y,17,()=>r,re,(m,I)=>{var L=Pa(),D={},B=V(L,!0);C(L),j(()=>{D!==(D=p(I).MaterialId)&&(L.value=(L.__value=p(I).MaterialId)??""),X(B,p(I).Namn)}),T(m,L)}),C(b);var o=w(b,2);K(o);var u=w(o,2);K(u);var J=w(u,2);K(J);var x=w(J,4);K(x);var k=w(x,2);K(k);var O=w(k,2);K(O);var R=w(O,2);R.__click=v;var P=w(R,2);{var q=m=>{var I=Ha(),L=V(I);C(I),j(D=>X(L,`ban ${D??""} an`),[()=>JSON.stringify(p(n),null,2)]),T(m,I)};Y(P,m=>{p(n)&&m(q)})}ya(b,()=>t.materialId,m=>t.materialId=m),z(o,()=>t.antal,m=>t.antal=m),z(u,()=>t.från,m=>t.från=m),z(J,()=>t.till,m=>t.till=m),z(x,()=>t.ansvarig.namn,m=>t.ansvarig.namn=m),z(k,()=>t.ansvarig.epost,m=>t.ansvarig.epost=m),z(O,()=>t.ansvarig.telefonnummer,m=>t.ansvarig.telefonnummer=m),T(c,h)},d=c=>{var h=qa();T(c,h)};Y(_,c=>{Array.isArray(r)&&r.length>0?c(s):c(d,!1)})}var f=w(_,2);Na(f,{}),z(A,()=>p(l),c=>N(l,c)),T(e,S),Le()}oa(["click"]);export{za as component};
