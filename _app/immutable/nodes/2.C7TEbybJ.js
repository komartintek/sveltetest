import{t as w,a as N}from"../chunks/i4SAYe-U.js";import{i as be}from"../chunks/CS5ISnyU.js";import{h as K,d as $e,b as Re,o as i,a6 as Ae,r as qe,e as De,f as pe,s as se,g as oe,k as Z,a0 as Fe,i as Ie,j as Se,p as Ue,a4 as Ee,Y as Be,m as Y,a7 as me,a8 as ie,Q as he,a9 as de,aa as ge,ab as Je,a3 as Ve,ac as Ye,D as Ge,ad as _e,ae as Qe,_ as Xe,O as je,N as We,af as xe,X as Ze,ag as ze,ah as ea,ai as aa,aj as ra,ak as ta,a as na,al as la,am as Te,an as sa,G as Ne,ao as we,ap as Le,M as I,F as ne,J as Me,v as C,K as V,L as H,I as W,aq as oa,ar as G}from"../chunks/DZVzPhGv.js";import{a as ia,l as Oe,e as ue,s as z}from"../chunks/mH8pkYhF.js";import{i as j,s as He,a as Ce}from"../chunks/DOuXPHa7.js";import{w as va}from"../chunks/DgQpC51A.js";function re(e,a){return a}function fa(e,a,r,v){for(var t=[],s=a.length,f=0;f<s;f++)Je(a[f].e,t,!0);var l=s>0&&t.length===0&&r!==null;if(l){var k=r.parentNode;Ve(k),k.append(r),v.clear(),J(e,a[0].prev,a[s-1].next)}Ye(t,()=>{for(var b=0;b<s;b++){var m=a[b];l||(v.delete(m.k),J(e,m.prev,m.next)),Ge(m.e,!l)}})}function te(e,a,r,v,t,s=null){var f=e,l={flags:a,items:new Map,first:null},k=(a&xe)!==0;if(k){var b=e;f=K?se(je(b)):b.appendChild(We())}K&&$e();var m=null,P=!1,u=Ae(()=>{var p=r();return Be(p)?p:p==null?[]:Ee(p)});Re(()=>{var p=i(u),n=p.length;if(P&&n===0)return;P=n===0;let h=!1;if(K){var y=qe(f)===De;y!==(n===0)&&(f=pe(),se(f),oe(!1),h=!0)}if(K){for(var S=null,g,c=0;c<n;c++){if(Z.nodeType===8&&Z.data===Fe){f=Z,h=!0,oe(!1);break}var o=p[c],d=v(o,c);g=Pe(Z,l,S,null,o,d,c,t,a,r),l.items.set(d,g),S=g}n>0&&se(pe())}K||ua(p,l,f,t,a,v,r),s!==null&&(n===0?m?Ie(m):m=Se(()=>s(f)):m!==null&&Ue(m,()=>{m=null})),h&&oe(!0),i(u)}),K&&(f=Z)}function ua(e,a,r,v,t,s,f){var D,F,U,_;var l=(t&ze)!==0,k=(t&(_e|de))!==0,b=e.length,m=a.items,P=a.first,u=P,p,n=null,h,y=[],S=[],g,c,o,d;if(l)for(d=0;d<b;d+=1)g=e[d],c=s(g,d),o=m.get(c),o!==void 0&&((D=o.a)==null||D.measure(),(h??(h=new Set)).add(o));for(d=0;d<b;d+=1){if(g=e[d],c=s(g,d),o=m.get(c),o===void 0){var L=u?u.e.nodes_start:r;n=Pe(L,a,n,n===null?a.first:n.next,g,c,d,v,t,f),m.set(c,n),y=[],S=[],u=n.next;continue}if(k&&ca(o,g,d,t),(o.e.f&ie)!==0&&(Ie(o.e),l&&((F=o.a)==null||F.unfix(),(h??(h=new Set)).delete(o))),o!==u){if(p!==void 0&&p.has(o)){if(y.length<S.length){var M=S[0],A;n=M.prev;var R=y[0],x=y[y.length-1];for(A=0;A<y.length;A+=1)ye(y[A],M,r);for(A=0;A<S.length;A+=1)p.delete(S[A]);J(a,R.prev,x.next),J(a,n,R),J(a,x,M),u=M,n=x,d-=1,y=[],S=[]}else p.delete(o),ye(o,u,r),J(a,o.prev,o.next),J(a,o,n===null?a.first:n.next),J(a,n,o),n=o;continue}for(y=[],S=[];u!==null&&u.k!==c;)(u.e.f&ie)===0&&(p??(p=new Set)).add(u),S.push(u),u=u.next;if(u===null)continue;o=u}y.push(o),n=o,u=o.next}if(u!==null||p!==void 0){for(var E=p===void 0?[]:Ee(p);u!==null;)(u.e.f&ie)===0&&E.push(u),u=u.next;var O=E.length;if(O>0){var q=(t&xe)!==0&&b===0?r:null;if(l){for(d=0;d<O;d+=1)(U=E[d].a)==null||U.measure();for(d=0;d<O;d+=1)(_=E[d].a)==null||_.fix()}fa(a,E,q,m)}}l&&Ze(()=>{var T;if(h!==void 0)for(o of h)(T=o.a)==null||T.apply()}),he.first=a.first&&a.first.e,he.last=n&&n.e}function ca(e,a,r,v){(v&_e)!==0&&ge(e.v,a),(v&de)!==0?ge(e.i,r):e.i=r}function Pe(e,a,r,v,t,s,f,l,k,b){var m=(k&_e)!==0,P=(k&Qe)===0,u=m?P?Y(t):me(t):t,p=(k&de)===0?f:me(f),n={i:p,v:u,k:s,a:null,e:null,prev:r,next:v};try{return n.e=Se(()=>l(e,u,p,b),K),n.e.prev=r&&r.e,n.e.next=v&&v.e,r===null?a.first=n:(r.next=n,r.e.next=n.e),v!==null&&(v.prev=n,v.e.prev=n.e),n}finally{}}function ye(e,a,r){for(var v=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,s=e.e.nodes_start;s!==v;){var f=Xe(s);t.before(s),s=f}}function J(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const da=Symbol("is custom element"),_a=Symbol("is html");function Q(e){if(K){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var v=e.value;ke(e,"value",null),e.value=v}if(e.hasAttribute("checked")){var t=e.checked;ke(e,"checked",null),e.checked=t}}};e.__on_r=r,ea(r),ia()}}function ke(e,a,r,v){var t=pa(e);K&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[aa]=r),e.removeAttribute(a))}function pa(e){return e.__attributes??(e.__attributes={[da]:e.nodeName.includes("-"),[_a]:e.namespaceURI===ra})}function X(e,a,r=a){var v=ta();Oe(e,"input",t=>{var s=t?e.defaultValue:e.value;if(s=ve(e)?fe(s):s,r(s),v&&s!==(s=a())){var f=e.selectionStart,l=e.selectionEnd;e.value=s??"",l!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(l,e.value.length))}}),(K&&e.defaultValue!==e.value||na(a)==null&&e.value)&&r(ve(e)?fe(e.value):e.value),la(()=>{var t=a();ve(e)&&t===fe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function ve(e){var a=e.type;return a==="number"||a==="range"}function fe(e){return e===""?null:+e}function Ke(e,a,r){if(e.multiple)return ga(e,a);for(var v of e.options){var t=ee(v);if(sa(t,a)){v.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ma(e,a){Te(()=>{var r=new MutationObserver(()=>{var v=e.__value;Ke(e,v)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ha(e,a,r=a){var v=!0;Oe(e,"change",t=>{var s=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(s),ee);else{var l=e.querySelector(s)??e.querySelector("option:not([disabled])");f=l&&ee(l)}r(f)}),Te(()=>{var t=a();if(Ke(e,t,v),v&&t===void 0){var s=e.querySelector(":checked");s!==null&&(t=ee(s),r(t))}e.__value=t,v=!1}),ma(e)}function ga(e,a){for(var r of e.options)r.selected=~a.indexOf(ee(r))}function ee(e){return"__value"in e?e.__value:e.value}const ce="https://script.google.com/macros/s/AKfycbx37QQFI7hnNU6Hv4E2AsZHBm4CO0u2uWko42K6grUJoEI4vI7krWXa1GxEADLZjH9x/exec",ya=localStorage.getItem("api_key"),ae=va(ya);ae.subscribe(e=>{localStorage.setItem("api_key",e||"")});var ka=w("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ba=w("<p>Laddar lagersaldo...</p>"),Aa=w('<p style="color: red;"> </p>'),Ia=w("<th> </th>"),Sa=w("<td> </td>"),Ea=w("<tr></tr>"),xa=w("<table><thead><tr></tr></thead><tbody></tbody></table>"),Ta=w("<p>Inget saldo tillgängligt.</p>"),Na=w("<h2>Lagersaldo</h2> <!>",1);function wa(e,a){Ne(a,!1);const[r,v]=He(),t=()=>Ce(ae,"$apiKey",r);let s=Y([]),f=Y(!1),l=Y(null);async function k(){C(f,!0),C(l,null);try{console.log("Hämtar lagersaldo med nyckel:",t());const n=await fetch(`${ce}?key=${t()}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",n),!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const h=await n.json();console.log("JSON-data från lagersaldo-API:",h),C(s,Array.isArray(h.saldo)?h.saldo:[])}catch(n){console.error("Fel vid hämtning av lagersaldo:",n),C(l,n.message)}finally{C(f,!1)}}function b(){const n=prompt("Ange din API-nyckel:");n&&ae.set(n)}we(()=>t(),()=>{t()&&k()}),Le(),be();var m=Na(),P=I(ne(m),2);{var u=n=>{var h=ka(),y=I(ne(h),2);ue("click",y,b),N(n,h)},p=(n,h)=>{{var y=g=>{var c=ba();N(g,c)},S=(g,c)=>{{var o=L=>{var M=Aa(),A=V(M,!0);H(M),W(()=>z(A,i(l))),N(L,M)},d=(L,M)=>{{var A=x=>{var E=xa(),O=V(E),q=V(O);te(q,5,()=>Object.keys(i(s)[0]),re,(F,U)=>{var _=Ia(),T=V(_,!0);H(_),W(()=>z(T,i(U))),N(F,_)}),H(q),H(O);var D=I(O);te(D,5,()=>i(s),re,(F,U)=>{var _=Ea();te(_,5,()=>Object.values(i(U)),re,(T,$)=>{var B=Sa(),le=V(B,!0);H(B),W(()=>z(le,i($))),N(T,B)}),H(_),N(F,_)}),H(D),H(E),N(x,E)},R=x=>{var E=Ta();N(x,E)};j(L,x=>{Array.isArray(i(s))&&i(s).length>0?x(A):x(R,!1)},M)}};j(g,L=>{i(l)?L(o):L(d,!1)},c)}};j(n,g=>{i(f)?g(y):g(S,!1)},h)}};j(P,n=>{t()?n(p,!1):n(u)})}N(e,m),Me(),v()}var La=w("<option> </option>"),Ma=w("<pre> </pre>"),Oa=w('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ha=w("<p>Laddar material eller saknar API-nyckel...</p>"),Ca=w('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Fa(e,a){Ne(a,!1);const[r,v]=He(),t=()=>Ce(ae,"$apiKey",r);let s=Y([]),f=Y(null),l=Y({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),k=Y(t()||"");async function b(){try{console.log("Hämtar material med nyckel:",t());const o=await(await fetch(`${ce}?key=${t()}&action=material`)).json();console.log("API-svar material:",o),C(s,Array.isArray(o.material)?o.material:[])}catch(c){console.error("Fel vid hämtning av material:",c),C(s,[])}}function m(){console.log("Sparar API-nyckel:",i(k)),ae.set(i(k)),b()}async function P(){C(f,null);try{console.log("Skickar bokning:",i(l));const o=await(await fetch(`${ce}?key=${t()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(i(l))})).json();console.log("API-svar bokning:",o),C(f,o)}catch(c){console.error("Fel vid bokning:",c),C(f,{error:c.message})}}we(()=>t(),()=>{t()&&b()}),Le(),be();var u=Ca(),p=I(ne(u),2);Q(p);var n=I(p,2),h=I(n,2);{var y=c=>{var o=Oa(),d=ne(o);W(()=>{i(l),oa(()=>{i(s)})});var L=V(d);L.value=L.__value="";var M=I(L);te(M,1,()=>i(s),re,(_,T)=>{var $=La(),B={},le=V($,!0);H($),W(()=>{B!==(B=i(T).MaterialId)&&($.value=($.__value=i(T).MaterialId)??""),z(le,i(T).Namn)}),N(_,$)}),H(d);var A=I(d,2);Q(A);var R=I(A,2);Q(R);var x=I(R,2);Q(x);var E=I(x,4);Q(E);var O=I(E,2);Q(O);var q=I(O,2);Q(q);var D=I(q,2),F=I(D,2);{var U=_=>{var T=Ma(),$=V(T,!0);H(T),W(B=>z($,B),[()=>JSON.stringify(i(f),null,2)],Ae),N(_,T)};j(F,_=>{i(f)&&_(U)})}ha(d,()=>i(l).materialId,_=>G(l,i(l).materialId=_)),X(A,()=>i(l).antal,_=>G(l,i(l).antal=_)),X(R,()=>i(l).från,_=>G(l,i(l).från=_)),X(x,()=>i(l).till,_=>G(l,i(l).till=_)),X(E,()=>i(l).ansvarig.namn,_=>G(l,i(l).ansvarig.namn=_)),X(O,()=>i(l).ansvarig.epost,_=>G(l,i(l).ansvarig.epost=_)),X(q,()=>i(l).ansvarig.telefonnummer,_=>G(l,i(l).ansvarig.telefonnummer=_)),ue("click",D,P),N(c,o)},S=c=>{var o=Ha();N(c,o)};j(h,c=>{Array.isArray(i(s))&&i(s).length>0?c(y):c(S,!1)})}var g=I(h,2);wa(g,{}),X(p,()=>i(k),c=>C(k,c)),ue("click",n,m),N(e,u),Me(),v()}export{Fa as component};
