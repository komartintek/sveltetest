import{t as M,a as w}from"../chunks/6gE4WjDV.js";import{h as H,a as Me,b as Ne,q as h,a9 as Ce,r as Oe,c as Pe,d as pe,s as le,e as ie,i as $,Z as He,f as Ae,g as ke,p as Re,a1 as be,R as qe,ae as j,ao as ue,ap as oe,L as me,aq as ce,ar as he,as as De,a0 as Be,at as Ve,y as Fe,au as de,av as Ke,X as ze,J as Je,I as Ue,aw as Ie,V as Ye,ax as Ge,ay as $e,az as Xe,aA as Ze,aB as Qe,k as We,a4 as je,a3 as Se,aC as ea,ad as N,ac as re,A as Ee,aD as aa,aE as ra,G as E,z as te,C as xe,D as F,F as C,B as X,al as fe}from"../chunks/BIZTmQUP.js";import{a as ta,l as Le,e as na,s as Z,d as la}from"../chunks/DdpKz3ms.js";import{i as G}from"../chunks/CYQ14GS-.js";import{i as ia}from"../chunks/win48-2-.js";function ee(e,a){return a}function oa(e,a,r,n){for(var t=[],o=a.length,f=0;f<o;f++)De(a[f].e,t,!0);var _=o>0&&t.length===0&&r!==null;if(_){var x=r.parentNode;Be(x),x.append(r),n.clear(),V(e,a[0].prev,a[o-1].next)}Ve(t,()=>{for(var A=0;A<o;A++){var g=a[A];_||(n.delete(g.k),V(e,g.prev,g.next)),Fe(g.e,!_)}})}function ae(e,a,r,n,t,o=null){var f=e,_={flags:a,items:new Map,first:null},x=(a&Ie)!==0;if(x){var A=e;f=H?le(Je(A)):A.appendChild(Ue())}H&&Me();var g=null,c=!1,l=Ce(()=>{var d=r();return qe(d)?d:d==null?[]:be(d)});Ne(()=>{var d=h(l),s=d.length;if(c&&s===0)return;c=s===0;let u=!1;if(H){var m=Oe(f)===Pe;m!==(s===0)&&(f=pe(),le(f),ie(!1),u=!0)}if(H){for(var k=null,S,y=0;y<s;y++){if($.nodeType===8&&$.data===He){f=$,u=!0,ie(!1);break}var i=d[y],v=n(i,y);S=Te($,_,k,null,i,v,y,t,a,r),_.items.set(v,S),k=S}s>0&&le(pe())}H||sa(d,_,f,t,a,n,r),o!==null&&(s===0?g?Ae(g):g=ke(()=>o(f)):g!==null&&Re(g,()=>{g=null})),u&&ie(!0),h(l)}),H&&(f=$)}function sa(e,a,r,n,t,o,f){var I,T,D,B;var _=(t&Ge)!==0,x=(t&(de|ce))!==0,A=e.length,g=a.items,c=a.first,l=c,d,s=null,u,m=[],k=[],S,y,i,v;if(_)for(v=0;v<A;v+=1)S=e[v],y=o(S,v),i=g.get(y),i!==void 0&&((I=i.a)==null||I.measure(),(u??(u=new Set)).add(i));for(v=0;v<A;v+=1){if(S=e[v],y=o(S,v),i=g.get(y),i===void 0){var K=l?l.e.nodes_start:r;s=Te(K,a,s,s===null?a.first:s.next,S,y,v,n,t,f),g.set(y,s),m=[],k=[],l=s.next;continue}if(x&&va(i,S,v,t),(i.e.f&oe)!==0&&(Ae(i.e),_&&((T=i.a)==null||T.unfix(),(u??(u=new Set)).delete(i))),i!==l){if(d!==void 0&&d.has(i)){if(m.length<k.length){var L=k[0],b;s=L.prev;var O=m[0],R=m[m.length-1];for(b=0;b<m.length;b+=1)ge(m[b],L,r);for(b=0;b<k.length;b+=1)d.delete(k[b]);V(a,O.prev,R.next),V(a,s,O),V(a,R,L),l=L,s=R,v-=1,m=[],k=[]}else d.delete(i),ge(i,l,r),V(a,i.prev,i.next),V(a,i,s===null?a.first:s.next),V(a,s,i),s=i;continue}for(m=[],k=[];l!==null&&l.k!==y;)(l.e.f&oe)===0&&(d??(d=new Set)).add(l),k.push(l),l=l.next;if(l===null)continue;i=l}m.push(i),s=i,l=i.next}if(l!==null||d!==void 0){for(var P=d===void 0?[]:be(d);l!==null;)(l.e.f&oe)===0&&P.push(l),l=l.next;var q=P.length;if(q>0){var p=(t&Ie)!==0&&A===0?r:null;if(_){for(v=0;v<q;v+=1)(D=P[v].a)==null||D.measure();for(v=0;v<q;v+=1)(B=P[v].a)==null||B.fix()}oa(a,P,p,g)}}_&&Ye(()=>{var W;if(u!==void 0)for(i of u)(W=i.a)==null||W.apply()}),me.first=a.first&&a.first.e,me.last=s&&s.e}function va(e,a,r,n){(n&de)!==0&&he(e.v,a),(n&ce)!==0?he(e.i,r):e.i=r}function Te(e,a,r,n,t,o,f,_,x,A){var g=(x&de)!==0,c=(x&Ke)===0,l=g?c?j(t):ue(t):t,d=(x&ce)===0?f:ue(f),s={i:d,v:l,k:o,a:null,e:null,prev:r,next:n};try{return s.e=ke(()=>_(e,l,d,A),H),s.e.prev=r&&r.e,s.e.next=n&&n.e,r===null?a.first=s:(r.next=s,r.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function ge(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,o=e.e.nodes_start;o!==n;){var f=ze(o);t.before(o),o=f}}function V(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const ua=Symbol("is custom element"),fa=Symbol("is html");function z(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;ye(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var t=e.checked;ye(e,"checked",null),e.checked=t}}};e.__on_r=r,$e(r),ta()}}function ye(e,a,r,n){var t=ca(e);H&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[Xe]=r),e.removeAttribute(a))}function ca(e){return e.__attributes??(e.__attributes={[ua]:e.nodeName.includes("-"),[fa]:e.namespaceURI===Ze})}function J(e,a,r=a){var n=Qe();Le(e,"input",t=>{var o=t?e.defaultValue:e.value;if(o=se(e)?ve(o):o,r(o),n&&o!==(o=a())){var f=e.selectionStart,_=e.selectionEnd;e.value=o??"",_!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(_,e.value.length))}}),(H&&e.defaultValue!==e.value||We(a)==null&&e.value)&&r(se(e)?ve(e.value):e.value),je(()=>{var t=a();se(e)&&t===ve(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function se(e){var a=e.type;return a==="number"||a==="range"}function ve(e){return e===""?null:+e}function we(e,a,r){if(e.multiple)return pa(e,a);for(var n of e.options){var t=Q(n);if(ea(t,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function da(e,a){Se(()=>{var r=new MutationObserver(()=>{var n=e.__value;we(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function _a(e,a,r=a){var n=!0;Le(e,"change",t=>{var o=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(o),Q);else{var _=e.querySelector(o)??e.querySelector("option:not([disabled])");f=_&&Q(_)}r(f)}),Se(()=>{var t=a();if(we(e,t,n),n&&t===void 0){var o=e.querySelector(":checked");o!==null&&(t=Q(o),r(t))}e.__value=t,n=!1}),da(e)}function pa(e,a){for(var r of e.options)r.selected=~a.indexOf(Q(r))}function Q(e){return"__value"in e?e.__value:e.value}function ma(e){var a=ue(0);return function(){return arguments.length===1?(N(a,h(a)+1),arguments[0]):(h(a),e())}}const _e="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",Y=re({value:localStorage.getItem("api_key")??""});var U=ma(()=>Y),ha=M("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ga=M("<p>Laddar lagersaldo...</p>"),ya=M('<p style="color: red;"> </p>'),Aa=M("<th> </th>"),ka=M("<td> </td>"),ba=M("<tr></tr>"),Ia=M("<table><thead><tr></tr></thead><tbody></tbody></table>"),Sa=M("<p>Inget saldo tillgängligt.</p>"),Ea=M("<h2>Lagersaldo</h2> <!>",1);function xa(e,a){Ee(a,!1);let r=j([]),n=j(!1),t=j(null);async function o(){N(n,!0),N(t,null);try{console.log("Hämtar lagersaldo med nyckel:",U().value);const c=await fetch(`${_e}?key=${U().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",c),!c.ok)throw new Error(`Fel vid hämtning: ${c.status}`);const l=await c.json();console.log("JSON-data från lagersaldo-API:",l),N(r,Array.isArray(l.saldo)?l.saldo:[])}catch(c){console.error("Fel vid hämtning av lagersaldo:",c),N(t,c.message)}finally{N(n,!1)}}function f(){const c=prompt("Ange din API-nyckel:");c&&U(U().value=c)}aa(()=>U(),()=>{U().value&&o()}),ra(),ia();var _=Ea(),x=E(te(_),2);{var A=c=>{var l=ha(),d=E(te(l),2);na("click",d,f),w(c,l)},g=(c,l)=>{{var d=u=>{var m=ga();w(u,m)},s=(u,m)=>{{var k=y=>{var i=ya(),v=F(i,!0);C(i),X(()=>Z(v,h(t))),w(y,i)},S=(y,i)=>{{var v=L=>{var b=Ia(),O=F(b),R=F(O);ae(R,5,()=>Object.keys(h(r)[0]),ee,(q,p)=>{var I=Aa(),T=F(I,!0);C(I),X(()=>Z(T,h(p))),w(q,I)}),C(R),C(O);var P=E(O);ae(P,5,()=>h(r),ee,(q,p)=>{var I=ba();ae(I,5,()=>Object.values(h(p)),ee,(T,D)=>{var B=ka(),W=F(B,!0);C(B),X(()=>Z(W,h(D))),w(T,B)}),C(I),w(q,I)}),C(P),C(b),w(L,b)},K=L=>{var b=Sa();w(L,b)};G(y,L=>{Array.isArray(h(r))&&h(r).length>0?L(v):L(K,!1)},i)}};G(u,y=>{h(t)?y(k):y(S,!1)},m)}};G(c,u=>{h(n)?u(d):u(s,!1)},l)}};G(x,c=>{U().value?c(g,!1):c(A)})}w(e,_),xe()}let ne=fe(re([])),La={getMaterialList:()=>(h(ne).length===0&&Ta(),h(ne))};async function Ta(){try{console.log("Hämtar material med nyckel:",Y.value);const a=await(await fetch(`${_e}?key=${Y.value}&action=material`)).json();console.log("API-svar material:",a),N(ne,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(ne,[],!0)}}var wa=M("<option> </option>"),Ma=M("<pre> </pre>"),Na=M('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ca=M("<p>Laddar material eller saknar API-nyckel...</p>"),Oa=M('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Ba(e,a){Ee(a,!0);let r=re(La.getMaterialList()),n=fe(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},o=fe(re(Y.value||""));function f(){console.log("Sparar API-nyckel:",h(o)),Y.value=h(o)}async function _(){N(n,null);try{console.log("Skickar bokning med nyckel:",Y.value);const m=await(await fetch(`${_e}?key=${Y.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",m),N(n,m,!0)}catch(u){console.error("Fel vid bokning:",u),N(n,{error:u instanceof Error?u.message:String(u)},!0)}}var x=Oa(),A=E(te(x),2);z(A);var g=E(A,2);g.__click=f;var c=E(g,2);{var l=u=>{var m=Na(),k=te(m),S=F(k);S.value=S.__value="";var y=E(S);ae(y,17,()=>r,ee,(p,I)=>{var T=wa(),D={},B=F(T,!0);C(T),X(()=>{D!==(D=h(I).MaterialId)&&(T.value=(T.__value=h(I).MaterialId)??""),Z(B,h(I).Namn)}),w(p,T)}),C(k);var i=E(k,2);z(i);var v=E(i,2);z(v);var K=E(v,2);z(K);var L=E(K,4);z(L);var b=E(L,2);z(b);var O=E(b,2);z(O);var R=E(O,2);R.__click=_;var P=E(R,2);{var q=p=>{var I=Ma(),T=F(I);C(I),X(D=>Z(T,`ban ${D??""} an`),[()=>JSON.stringify(h(n),null,2)]),w(p,I)};G(P,p=>{h(n)&&p(q)})}_a(k,()=>t.materialId,p=>t.materialId=p),J(i,()=>t.antal,p=>t.antal=p),J(v,()=>t.från,p=>t.från=p),J(K,()=>t.till,p=>t.till=p),J(L,()=>t.ansvarig.namn,p=>t.ansvarig.namn=p),J(b,()=>t.ansvarig.epost,p=>t.ansvarig.epost=p),J(O,()=>t.ansvarig.telefonnummer,p=>t.ansvarig.telefonnummer=p),w(u,m)},d=u=>{var m=Ca();w(u,m)};G(c,u=>{Array.isArray(r)&&r.length>0?u(l):u(d,!1)})}var s=E(c,2);xa(s,{}),J(A,()=>h(o),u=>N(o,u)),w(e,x),xe()}la(["click"]);export{Ba as component};
