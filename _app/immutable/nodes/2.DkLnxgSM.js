import{t as w,a as T}from"../chunks/6gE4WjDV.js";import{h as H,a as Ne,b as Ce,q as h,a9 as Oe,r as Pe,c as He,d as he,s as ne,e as le,i as $,Z as Re,f as ke,g as be,p as qe,a1 as Ie,R as De,ae as j,ao as ue,ap as ie,L as me,aq as ce,ar as ge,as as Be,a0 as Ve,at as Fe,y as Ke,au as _e,av as ze,X as Je,J as Ue,I as Ye,aw as Se,V as Ge,ax as $e,ay as Xe,az as Ze,aA as Qe,aB as We,k as je,a4 as ea,a3 as Ee,aC as aa,ad as N,ac as de,A as Le,aD as ra,aE as ta,G as E,z as re,C as xe,D as B,F as O,B as X,al as fe,u as na}from"../chunks/BIZTmQUP.js";import{a as la,l as Te,e as ia,s as Z,d as oa}from"../chunks/DdpKz3ms.js";import{i as G}from"../chunks/CYQ14GS-.js";import{i as sa}from"../chunks/win48-2-.js";function ee(e,a){return a}function va(e,a,r,t){for(var n=[],s=a.length,u=0;u<s;u++)Be(a[u].e,n,!0);var c=s>0&&n.length===0&&r!==null;if(c){var S=r.parentNode;Ve(S),S.append(r),t.clear(),D(e,a[0].prev,a[s-1].next)}Fe(n,()=>{for(var b=0;b<s;b++){var m=a[b];c||(t.delete(m.k),D(e,m.prev,m.next)),Ke(m.e,!c)}})}function ae(e,a,r,t,n,s=null){var u=e,c={flags:a,items:new Map,first:null},S=(a&Se)!==0;if(S){var b=e;u=H?ne(Ue(b)):b.appendChild(Ye())}H&&Ne();var m=null,_=!1,i=Oe(()=>{var d=r();return De(d)?d:d==null?[]:Ie(d)});Ce(()=>{var d=h(i),l=d.length;if(_&&l===0)return;_=l===0;let g=!1;if(H){var y=Pe(u)===He;y!==(l===0)&&(u=he(),ne(u),le(!1),g=!0)}if(H){for(var I=null,x,p=0;p<l;p++){if($.nodeType===8&&$.data===Re){u=$,g=!0,le(!1);break}var o=d[p],v=t(o,p);x=we($,c,I,null,o,v,p,n,a,r),c.items.set(v,x),I=x}l>0&&ne(he())}H||ua(d,c,u,n,a,t,r),s!==null&&(l===0?m?ke(m):m=be(()=>s(u)):m!==null&&qe(m,()=>{m=null})),g&&le(!0),h(i)}),H&&(u=$)}function ua(e,a,r,t,n,s,u){var k,C,U,Y;var c=(n&$e)!==0,S=(n&(_e|ce))!==0,b=e.length,m=a.items,_=a.first,i=_,d,l=null,g,y=[],I=[],x,p,o,v;if(c)for(v=0;v<b;v+=1)x=e[v],p=s(x,v),o=m.get(p),o!==void 0&&((k=o.a)==null||k.measure(),(g??(g=new Set)).add(o));for(v=0;v<b;v+=1){if(x=e[v],p=s(x,v),o=m.get(p),o===void 0){var V=i?i.e.nodes_start:r;l=we(V,a,l,l===null?a.first:l.next,x,p,v,t,n,u),m.set(p,l),y=[],I=[],i=l.next;continue}if(S&&fa(o,x,v,n),(o.e.f&ie)!==0&&(ke(o.e),c&&((C=o.a)==null||C.unfix(),(g??(g=new Set)).delete(o))),o!==i){if(d!==void 0&&d.has(o)){if(y.length<I.length){var L=I[0],A;l=L.prev;var R=y[0],q=y[y.length-1];for(A=0;A<y.length;A+=1)ye(y[A],L,r);for(A=0;A<I.length;A+=1)d.delete(I[A]);D(a,R.prev,q.next),D(a,l,R),D(a,q,L),i=L,l=q,v-=1,y=[],I=[]}else d.delete(o),ye(o,i,r),D(a,o.prev,o.next),D(a,o,l===null?a.first:l.next),D(a,l,o),l=o;continue}for(y=[],I=[];i!==null&&i.k!==p;)(i.e.f&ie)===0&&(d??(d=new Set)).add(i),I.push(i),i=i.next;if(i===null)continue;o=i}y.push(o),l=o,i=o.next}if(i!==null||d!==void 0){for(var P=d===void 0?[]:Ie(d);i!==null;)(i.e.f&ie)===0&&P.push(i),i=i.next;var f=P.length;if(f>0){var M=(n&Se)!==0&&b===0?r:null;if(c){for(v=0;v<f;v+=1)(U=P[v].a)==null||U.measure();for(v=0;v<f;v+=1)(Y=P[v].a)==null||Y.fix()}va(a,P,M,m)}}c&&Ge(()=>{var W;if(g!==void 0)for(o of g)(W=o.a)==null||W.apply()}),me.first=a.first&&a.first.e,me.last=l&&l.e}function fa(e,a,r,t){(t&_e)!==0&&ge(e.v,a),(t&ce)!==0?ge(e.i,r):e.i=r}function we(e,a,r,t,n,s,u,c,S,b){var m=(S&_e)!==0,_=(S&ze)===0,i=m?_?j(n):ue(n):n,d=(S&ce)===0?u:ue(u),l={i:d,v:i,k:s,a:null,e:null,prev:r,next:t};try{return l.e=be(()=>c(e,i,d,b),H),l.e.prev=r&&r.e,l.e.next=t&&t.e,r===null?a.first=l:(r.next=l,r.e.next=l.e),t!==null&&(t.prev=l,t.e.prev=l.e),l}finally{}}function ye(e,a,r){for(var t=e.next?e.next.e.nodes_start:r,n=a?a.e.nodes_start:r,s=e.e.nodes_start;s!==t;){var u=Je(s);n.before(s),s=u}}function D(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const ca=Symbol("is custom element"),_a=Symbol("is html");function F(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var t=e.value;Ae(e,"value",null),e.value=t}if(e.hasAttribute("checked")){var n=e.checked;Ae(e,"checked",null),e.checked=n}}};e.__on_r=r,Xe(r),la()}}function Ae(e,a,r,t){var n=da(e);H&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=r)&&(a==="loading"&&(e[Ze]=r),e.removeAttribute(a))}function da(e){return e.__attributes??(e.__attributes={[ca]:e.nodeName.includes("-"),[_a]:e.namespaceURI===Qe})}function K(e,a,r=a){var t=We();Te(e,"input",n=>{var s=n?e.defaultValue:e.value;if(s=oe(e)?se(s):s,r(s),t&&s!==(s=a())){var u=e.selectionStart,c=e.selectionEnd;e.value=s??"",c!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(c,e.value.length))}}),(H&&e.defaultValue!==e.value||je(a)==null&&e.value)&&r(oe(e)?se(e.value):e.value),ea(()=>{var n=a();oe(e)&&n===se(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function oe(e){var a=e.type;return a==="number"||a==="range"}function se(e){return e===""?null:+e}function Me(e,a,r){if(e.multiple)return ma(e,a);for(var t of e.options){var n=Q(t);if(aa(n,a)){t.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function pa(e,a){Ee(()=>{var r=new MutationObserver(()=>{var t=e.__value;Me(e,t)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ha(e,a,r=a){var t=!0;Te(e,"change",n=>{var s=n?"[selected]":":checked",u;if(e.multiple)u=[].map.call(e.querySelectorAll(s),Q);else{var c=e.querySelector(s)??e.querySelector("option:not([disabled])");u=c&&Q(c)}r(u)}),Ee(()=>{var n=a();if(Me(e,n,t),t&&n===void 0){var s=e.querySelector(":checked");s!==null&&(n=Q(s),r(n))}e.__value=n,t=!1}),pa(e)}function ma(e,a){for(var r of e.options)r.selected=~a.indexOf(Q(r))}function Q(e){return"__value"in e?e.__value:e.value}function ga(e){var a=ue(0);return function(){return arguments.length===1?(N(a,h(a)+1),arguments[0]):(h(a),e())}}const pe="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",J=de({value:localStorage.getItem("api_key")??""});var z=ga(()=>J),ya=w("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Aa=w("<p>Laddar lagersaldo...</p>"),ka=w('<p style="color: red;"> </p>'),ba=w("<th> </th>"),Ia=w("<td> </td>"),Sa=w("<tr></tr>"),Ea=w("<table><thead><tr></tr></thead><tbody></tbody></table>"),La=w("<p>Inget saldo tillgängligt.</p>"),xa=w("<h2>Lagersaldo</h2> <!>",1);function Ta(e,a){Le(a,!1);let r=j([]),t=j(!1),n=j(null);async function s(){N(t,!0),N(n,null);try{console.log("Hämtar lagersaldo med nyckel:",z().value);const _=await fetch(`${pe}?key=${z().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",_),!_.ok)throw new Error(`Fel vid hämtning: ${_.status}`);const i=await _.json();console.log("JSON-data från lagersaldo-API:",i),N(r,Array.isArray(i.saldo)?i.saldo:[])}catch(_){console.error("Fel vid hämtning av lagersaldo:",_),N(n,_.message)}finally{N(t,!1)}}function u(){const _=prompt("Ange din API-nyckel:");_&&z(z().value=_)}ra(()=>z(),()=>{z().value&&s()}),ta(),sa();var c=xa(),S=E(re(c),2);{var b=_=>{var i=ya(),d=E(re(i),2);ia("click",d,u),T(_,i)},m=(_,i)=>{{var d=g=>{var y=Aa();T(g,y)},l=(g,y)=>{{var I=p=>{var o=ka(),v=B(o,!0);O(o),X(()=>Z(v,h(n))),T(p,o)},x=(p,o)=>{{var v=L=>{var A=Ea(),R=B(A),q=B(R);ae(q,5,()=>Object.keys(h(r)[0]),ee,(f,M)=>{var k=ba(),C=B(k,!0);O(k),X(()=>Z(C,h(M))),T(f,k)}),O(q),O(R);var P=E(R);ae(P,5,()=>h(r),ee,(f,M)=>{var k=Sa();ae(k,5,()=>Object.values(h(M)),ee,(C,U)=>{var Y=Ia(),W=B(Y,!0);O(Y),X(()=>Z(W,h(U))),T(C,Y)}),O(k),T(f,k)}),O(P),O(A),T(L,A)},V=L=>{var A=La();T(L,A)};G(p,L=>{Array.isArray(h(r))&&h(r).length>0?L(v):L(V,!1)},o)}};G(g,p=>{h(n)?p(I):p(x,!1)},y)}};G(_,g=>{h(t)?g(d):g(l,!1)},i)}};G(S,_=>{z().value?_(m,!1):_(b)})}T(e,c),xe()}let te=fe(de([])),ve={getMaterialList:()=>(h(te).length===0&&wa(),h(te))};async function wa(){try{console.log("Hämtar material med nyckel:",J.value);const a=await(await fetch(`${pe}?key=${J.value}&action=material`)).json();console.log("API-svar material:",a),N(te,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(te,[],!0)}}var Ma=w("<option> </option>"),Na=w("<pre> </pre>"),Ca=w('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Oa=w("<p>Laddar material eller saknar API-nyckel...</p>"),Pa=w('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Va(e,a){Le(a,!0);let r=fe(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},n=fe(de(J.value||""));na(()=>{});function s(){console.log("Sparar API-nyckel:",h(n)),J.value=h(n)}async function u(){N(r,null);try{console.log("Skickar bokning med nyckel:",J.value);const g=await(await fetch(`${pe}?key=${J.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",g),N(r,g,!0)}catch(l){console.error("Fel vid bokning:",l),N(r,{error:l instanceof Error?l.message:String(l)},!0)}}var c=Pa(),S=E(re(c),2);F(S);var b=E(S,2);b.__click=s;var m=E(b,2);{var _=l=>{var g=Ca(),y=re(g),I=B(y);I.value=I.__value="";var x=E(I);ae(x,17,()=>ve.getMaterialList(),ee,(f,M)=>{var k=Ma(),C={},U=B(k,!0);O(k),X(()=>{C!==(C=h(M).MaterialId)&&(k.value=(k.__value=h(M).MaterialId)??""),Z(U,h(M).Namn)}),T(f,k)}),O(y);var p=E(y,2);F(p);var o=E(p,2);F(o);var v=E(o,2);F(v);var V=E(v,4);F(V);var L=E(V,2);F(L);var A=E(L,2);F(A);var R=E(A,2);R.__click=u;var q=E(R,2);{var P=f=>{var M=Na(),k=B(M);O(M),X(C=>Z(k,`ban ${C??""} an`),[()=>JSON.stringify(h(r),null,2)]),T(f,M)};G(q,f=>{h(r)&&f(P)})}ha(y,()=>t.materialId,f=>t.materialId=f),K(p,()=>t.antal,f=>t.antal=f),K(o,()=>t.från,f=>t.från=f),K(v,()=>t.till,f=>t.till=f),K(V,()=>t.ansvarig.namn,f=>t.ansvarig.namn=f),K(L,()=>t.ansvarig.epost,f=>t.ansvarig.epost=f),K(A,()=>t.ansvarig.telefonnummer,f=>t.ansvarig.telefonnummer=f),T(l,g)},i=l=>{var g=Oa();T(l,g)};G(m,l=>{Array.isArray(ve.getMaterialList())&&ve.getMaterialList().length>0?l(_):l(i,!1)})}var d=E(m,2);Ta(d,{}),K(S,()=>h(n),l=>N(n,l)),T(e,c),xe()}oa(["click"]);export{Va as component};
