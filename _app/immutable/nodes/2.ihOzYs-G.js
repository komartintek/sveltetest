import{t as O,a as M}from"../chunks/BlccSK2Q.js";import{i as Ka}from"../chunks/CNjbfXTh.js";import{h as K,d as Ra,b as qa,o,a6 as ya,r as Da,e as Pa,f as _a,s as na,g as la,k as j,a0 as Ua,i as ga,j as ba,p as Ba,a4 as Aa,X as Fa,m as Y,a7 as ca,a8 as sa,Q as da,a9 as va,aa as pa,ab as Va,a3 as Ja,ac as Ya,D as Ga,ad as ua,ae as Qa,_ as Xa,O as ja,N as Wa,af as ka,Y as Za,ag as za,ah as ae,ai as ee,aj as re,ak as te,a as ne,al as le,am as Ia,an as se,G as Ea,ao as Sa,ap as xa,M as E,F as ra,J as Ta,v as U,K as B,L as $,I as X,aq as ie,ar as F}from"../chunks/DX3K2HII.js";import{a as oe,l as wa,e as Na,s as W}from"../chunks/CnsorDfL.js";import{i as Q,s as La,a as Ma,b as fe}from"../chunks/BXXhmYsE.js";import{w as ve}from"../chunks/Deb-V3KV.js";function aa(a,e){return e}function ue(a,e,r,i){for(var t=[],s=e.length,f=0;f<s;f++)Va(e[f].e,t,!0);var l=s>0&&t.length===0&&r!==null;if(l){var S=r.parentNode;Ja(S),S.append(r),i.clear(),P(a,e[0].prev,e[s-1].next)}Ya(t,()=>{for(var A=0;A<s;A++){var p=e[A];l||(i.delete(p.k),P(a,p.prev,p.next)),Ga(p.e,!l)}})}function ea(a,e,r,i,t,s=null){var f=a,l={flags:e,items:new Map,first:null},S=(e&ka)!==0;if(S){var A=a;f=K?na(ja(A)):A.appendChild(Wa())}K&&Ra();var p=null,C=!1,v=ya(()=>{var h=r();return Fa(h)?h:h==null?[]:Aa(h)});qa(()=>{var h=o(v),n=h.length;if(C&&n===0)return;C=n===0;let b=!1;if(K){var c=Da(f)===Pa;c!==(n===0)&&(f=_a(),na(f),la(!1),b=!0)}if(K){for(var y=null,m,g=0;g<n;g++){if(j.nodeType===8&&j.data===Ua){f=j,b=!0,la(!1);break}var u=h[g],_=i(u,g);m=Oa(j,l,y,null,u,_,g,t,e,r),l.items.set(_,m),y=m}n>0&&na(_a())}K||_e(h,l,f,t,e,i,r),s!==null&&(n===0?p?ga(p):p=ba(()=>s(f)):p!==null&&Ba(p,()=>{p=null})),b&&la(!0),o(v)}),K&&(f=j)}function _e(a,e,r,i,t,s,f){var d,N,L,I;var l=(t&za)!==0,S=(t&(ua|va))!==0,A=a.length,p=e.items,C=e.first,v=C,h,n=null,b,c=[],y=[],m,g,u,_;if(l)for(_=0;_<A;_+=1)m=a[_],g=s(m,_),u=p.get(g),u!==void 0&&((d=u.a)==null||d.measure(),(b??(b=new Set)).add(u));for(_=0;_<A;_+=1){if(m=a[_],g=s(m,_),u=p.get(g),u===void 0){var H=v?v.e.nodes_start:r;n=Oa(H,e,n,n===null?e.first:n.next,m,g,_,i,t,f),p.set(g,n),c=[],y=[],v=n.next;continue}if(S&&ce(u,m,_,t),(u.e.f&sa)!==0&&(ga(u.e),l&&((N=u.a)==null||N.unfix(),(b??(b=new Set)).delete(u))),u!==v){if(h!==void 0&&h.has(u)){if(c.length<y.length){var x=y[0],k;n=x.prev;var q=c[0],T=c[c.length-1];for(k=0;k<c.length;k+=1)ha(c[k],x,r);for(k=0;k<y.length;k+=1)h.delete(y[k]);P(e,q.prev,T.next),P(e,n,q),P(e,T,x),v=x,n=T,_-=1,c=[],y=[]}else h.delete(u),ha(u,v,r),P(e,u.prev,u.next),P(e,u,n===null?e.first:n.next),P(e,n,u),n=u;continue}for(c=[],y=[];v!==null&&v.k!==g;)(v.e.f&sa)===0&&(h??(h=new Set)).add(v),y.push(v),v=v.next;if(v===null)continue;u=v}c.push(u),n=u,v=u.next}if(v!==null||h!==void 0){for(var w=h===void 0?[]:Aa(h);v!==null;)(v.e.f&sa)===0&&w.push(v),v=v.next;var R=w.length;if(R>0){var G=(t&ka)!==0&&A===0?r:null;if(l){for(_=0;_<R;_+=1)(L=w[_].a)==null||L.measure();for(_=0;_<R;_+=1)(I=w[_].a)==null||I.fix()}ue(e,w,G,p)}}l&&Za(()=>{var D;if(b!==void 0)for(u of b)(D=u.a)==null||D.apply()}),da.first=e.first&&e.first.e,da.last=n&&n.e}function ce(a,e,r,i){(i&ua)!==0&&pa(a.v,e),(i&va)!==0?pa(a.i,r):a.i=r}function Oa(a,e,r,i,t,s,f,l,S,A){var p=(S&ua)!==0,C=(S&Qa)===0,v=p?C?Y(t):ca(t):t,h=(S&va)===0?f:ca(f),n={i:h,v,k:s,a:null,e:null,prev:r,next:i};try{return n.e=ba(()=>l(a,v,h,A),K),n.e.prev=r&&r.e,n.e.next=i&&i.e,r===null?e.first=n:(r.next=n,r.e.next=n.e),i!==null&&(i.prev=n,i.e.prev=n.e),n}finally{}}function ha(a,e,r){for(var i=a.next?a.next.e.nodes_start:r,t=e?e.e.nodes_start:r,s=a.e.nodes_start;s!==i;){var f=Xa(s);t.before(s),s=f}}function P(a,e,r){e===null?a.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}const de=Symbol("is custom element"),pe=Symbol("is html");function V(a){if(K){var e=!1,r=()=>{if(!e){if(e=!0,a.hasAttribute("value")){var i=a.value;ma(a,"value",null),a.value=i}if(a.hasAttribute("checked")){var t=a.checked;ma(a,"checked",null),a.checked=t}}};a.__on_r=r,ae(r),oe()}}function ma(a,e,r,i){var t=he(a);K&&(t[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||t[e]!==(t[e]=r)&&(e==="loading"&&(a[ee]=r),a.removeAttribute(e))}function he(a){return a.__attributes??(a.__attributes={[de]:a.nodeName.includes("-"),[pe]:a.namespaceURI===re})}function J(a,e,r=e){var i=te();wa(a,"input",t=>{var s=t?a.defaultValue:a.value;if(s=ia(a)?oa(s):s,r(s),i&&s!==(s=e())){var f=a.selectionStart,l=a.selectionEnd;a.value=s??"",l!==null&&(a.selectionStart=f,a.selectionEnd=Math.min(l,a.value.length))}}),(K&&a.defaultValue!==a.value||ne(e)==null&&a.value)&&r(ia(a)?oa(a.value):a.value),le(()=>{var t=e();ia(a)&&t===oa(a.value)||a.type==="date"&&!t&&!a.value||t!==a.value&&(a.value=t??"")})}function ia(a){var e=a.type;return e==="number"||e==="range"}function oa(a){return a===""?null:+a}function Ca(a,e,r){if(a.multiple)return ge(a,e);for(var i of a.options){var t=Z(i);if(se(t,e)){i.selected=!0;return}}(!r||e!==void 0)&&(a.selectedIndex=-1)}function me(a,e){Ia(()=>{var r=new MutationObserver(()=>{var i=a.__value;Ca(a,i)});return r.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ye(a,e,r=e){var i=!0;wa(a,"change",t=>{var s=t?"[selected]":":checked",f;if(a.multiple)f=[].map.call(a.querySelectorAll(s),Z);else{var l=a.querySelector(s)??a.querySelector("option:not([disabled])");f=l&&Z(l)}r(f)}),Ia(()=>{var t=e();if(Ca(a,t,i),i&&t===void 0){var s=a.querySelector(":checked");s!==null&&(t=Z(s),r(t))}a.__value=t,i=!1}),me(a)}function ge(a,e){for(var r of a.options)r.selected=~e.indexOf(Z(r))}function Z(a){return"__value"in a?a.__value:a.value}const fa="https://script.google.com/macros/s/AKfycbx37QQFI7hnNU6Hv4E2AsZHBm4CO0u2uWko42K6grUJoEI4vI7krWXa1GxEADLZjH9x/exec",be=localStorage.getItem("api_key"),z=ve(be);z.subscribe(a=>{localStorage.setItem("api_key",a||"")});var Ae=O("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ke=O("<p>Laddar lagersaldo...</p>"),Ie=O('<p style="color: red;"> </p>'),Ee=O("<th> </th>"),Se=O("<td> </td>"),xe=O("<tr></tr>"),Te=O("<table><thead><tr></tr></thead><tbody></tbody></table>"),we=O("<p>Inget saldo tillgängligt.</p>"),Ne=O("<h2>Lagersaldo</h2> <!>",1);function Le(a,e){Ea(e,!1);const[r,i]=La(),t=()=>Ma(z,"$apiKey",r);let s=Y([]),f=Y(!1),l=Y(null);async function S(){U(f,!0),U(l,null);try{const n=await fetch(`${fa}?key=${t()}&type=saldo`);if(!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const b=await n.json();U(s,Array.isArray(b.saldo)?b.saldo:[])}catch(n){U(l,n.message)}finally{U(f,!1)}}function A(){const n=prompt("Ange din API-nyckel:");n&&z.set(n)}Sa(()=>t(),()=>{t()&&S()}),xa(),Ka();var p=Ne(),C=E(ra(p),2);{var v=n=>{var b=Ae(),c=E(ra(b),2);Na("click",c,A),M(n,b)},h=(n,b)=>{{var c=m=>{var g=ke();M(m,g)},y=(m,g)=>{{var u=H=>{var x=Ie(),k=B(x,!0);$(x),X(()=>W(k,o(l))),M(H,x)},_=(H,x)=>{{var k=T=>{var w=Te(),R=B(w),G=B(R);ea(G,5,()=>Object.keys(o(s)[0]),aa,(N,L)=>{var I=Ee(),D=B(I,!0);$(I),X(()=>W(D,o(L))),M(N,I)}),$(G),$(R);var d=E(R);ea(d,5,()=>o(s),aa,(N,L)=>{var I=xe();ea(I,5,()=>Object.values(o(L)),aa,(D,Ha)=>{var ta=Se(),$a=B(ta,!0);$(ta),X(()=>W($a,o(Ha))),M(D,ta)}),$(I),M(N,I)}),$(d),$(w),M(T,w)},q=T=>{var w=we();M(T,w)};Q(H,T=>{Array.isArray(o(s))&&o(s).length>0?T(k):T(q,!1)},x)}};Q(m,H=>{o(l)?H(u):H(_,!1)},g)}};Q(n,m=>{o(f)?m(c):m(y,!1)},b)}};Q(C,n=>{t()?n(h,!1):n(v)})}M(a,p),Ta(),i()}var Me=O("<option> </option>"),Oe=O("<pre> </pre>"),Ce=O('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),He=O("<p>Laddar material eller saknar API-nyckel...</p>"),$e=O('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <!> <!>',1);function Be(a,e){Ea(e,!1);const[r,i]=La(),t=()=>Ma(z,"$apiKey",r);let s=Y([]),f=Y(null),l=Y({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}});async function S(){const y=await(await fetch(`${fa}?key=${t()}`)).json();U(s,Array.isArray(y.material)?y.material:[])}async function A(){U(f,null);const c=await fetch(`${fa}?key=${t()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(o(l))});U(f,await c.json())}Sa(()=>t(),()=>{t()&&S()}),xa();var p=$e(),C=E(ra(p),2);V(C);var v=E(C,2);{var h=c=>{var y=Ce(),m=ra(y);X(()=>{o(l),ie(()=>{o(s)})});var g=B(m);g.value=g.__value="";var u=E(g);ea(u,1,()=>o(s),aa,(d,N)=>{var L=Me(),I={},D=B(L,!0);$(L),X(()=>{I!==(I=o(N).MaterialId)&&(L.value=(L.__value=o(N).MaterialId)??""),W(D,o(N).Namn)}),M(d,L)}),$(m);var _=E(m,2);V(_);var H=E(_,2);V(H);var x=E(H,2);V(x);var k=E(x,4);V(k);var q=E(k,2);V(q);var T=E(q,2);V(T);var w=E(T,2),R=E(w,2);{var G=d=>{var N=Oe(),L=B(N,!0);$(N),X(I=>W(L,I),[()=>JSON.stringify(o(f),null,2)],ya),M(d,N)};Q(R,d=>{o(f)&&d(G)})}ye(m,()=>o(l).materialId,d=>F(l,o(l).materialId=d)),J(_,()=>o(l).antal,d=>F(l,o(l).antal=d)),J(H,()=>o(l).från,d=>F(l,o(l).från=d)),J(x,()=>o(l).till,d=>F(l,o(l).till=d)),J(k,()=>o(l).ansvarig.namn,d=>F(l,o(l).ansvarig.namn=d)),J(q,()=>o(l).ansvarig.epost,d=>F(l,o(l).ansvarig.epost=d)),J(T,()=>o(l).ansvarig.telefonnummer,d=>F(l,o(l).ansvarig.telefonnummer=d)),Na("click",w,A),M(c,y)},n=c=>{var y=He();M(c,y)};Q(v,c=>{Array.isArray(o(s))&&o(s).length>0?c(h):c(n,!1)})}var b=E(v,2);Le(b,{}),J(C,t,c=>fe(z,c)),M(a,p),Ta(),i()}export{Be as component};
