import{t as M,a as T}from"../chunks/CNputRQq.js";import{R as be,ao as Ce,ap as Oe,h as H,a as Pe,b as He,q as h,a9 as Re,r as qe,c as De,d as pe,s as ie,e as se,i as $,Z as Be,f as ke,g as Ie,p as Fe,a1 as Se,ae as W,aq as ve,ar as oe,L as ge,as as _e,at as he,au as Ve,a0 as Je,av as Ke,y as ze,aw as de,ax as Ge,X as Ue,J as Ye,I as $e,ay as Ee,V as je,az as Xe,aA as Ze,aB as Qe,aC as We,aD as ea,k as aa,a4 as ra,a3 as we,aE as ta,ad as N,ac as te,A as xe,aF as na,aG as la,G as w,z as ne,C as Le,D as V,F as C,B as j,al as ce,u as ia}from"../chunks/Bul_6VOG.js";import{a as sa,l as Te,e as oa,s as X,d as fa}from"../chunks/D8gnIKhX.js";import{i as Y}from"../chunks/lkCOugSH.js";import{i as ua}from"../chunks/CdnbHVUu.js";const va=[];function ca(e,a=!1){return ee(e,new Map,"",va)}function ee(e,a,r,n,t=null){if(typeof e=="object"&&e!==null){var l=a.get(e);if(l!==void 0)return l;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(be(e)){var i=Array(e.length);a.set(e,i),t!==null&&a.set(t,i);for(var v=0;v<e.length;v+=1){var S=e[v];v in e&&(i[v]=ee(S,a,r,n))}return i}if(Ce(e)===Oe){i={},a.set(e,i),t!==null&&a.set(t,i);for(var A in e)i[A]=ee(e[A],a,r,n);return i}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return ee(e.toJSON(),a,r,n,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function ae(e,a){return a}function _a(e,a,r,n){for(var t=[],l=a.length,i=0;i<l;i++)Ve(a[i].e,t,!0);var v=l>0&&t.length===0&&r!==null;if(v){var S=r.parentNode;Je(S),S.append(r),n.clear(),F(e,a[0].prev,a[l-1].next)}Ke(t,()=>{for(var A=0;A<l;A++){var p=a[A];v||(n.delete(p.k),F(e,p.prev,p.next)),ze(p.e,!v)}})}function re(e,a,r,n,t,l=null){var i=e,v={flags:a,items:new Map,first:null},S=(a&Ee)!==0;if(S){var A=e;i=H?ie(Ye(A)):A.appendChild($e())}H&&Pe();var p=null,_=!1,s=Re(()=>{var d=r();return be(d)?d:d==null?[]:Se(d)});He(()=>{var d=h(s),f=d.length;if(_&&f===0)return;_=f===0;let c=!1;if(H){var g=qe(i)===De;g!==(f===0)&&(i=pe(),ie(i),se(!1),c=!0)}if(H){for(var b=null,E,y=0;y<f;y++){if($.nodeType===8&&$.data===Be){i=$,c=!0,se(!1);break}var o=d[y],u=n(o,y);E=Me($,v,b,null,o,u,y,t,a,r),v.items.set(u,E),b=E}f>0&&ie(pe())}H||da(d,v,i,t,a,n,r),l!==null&&(f===0?p?ke(p):p=Ie(()=>l(i)):p!==null&&Fe(p,()=>{p=null})),c&&se(!0),h(s)}),H&&(i=$)}function da(e,a,r,n,t,l,i){var I,L,D,B;var v=(t&Xe)!==0,S=(t&(de|_e))!==0,A=e.length,p=a.items,_=a.first,s=_,d,f=null,c,g=[],b=[],E,y,o,u;if(v)for(u=0;u<A;u+=1)E=e[u],y=l(E,u),o=p.get(y),o!==void 0&&((I=o.a)==null||I.measure(),(c??(c=new Set)).add(o));for(u=0;u<A;u+=1){if(E=e[u],y=l(E,u),o=p.get(y),o===void 0){var J=s?s.e.nodes_start:r;f=Me(J,a,f,f===null?a.first:f.next,E,y,u,n,t,i),p.set(y,f),g=[],b=[],s=f.next;continue}if(S&&ma(o,E,u,t),(o.e.f&oe)!==0&&(ke(o.e),v&&((L=o.a)==null||L.unfix(),(c??(c=new Set)).delete(o))),o!==s){if(d!==void 0&&d.has(o)){if(g.length<b.length){var x=b[0],k;f=x.prev;var O=g[0],R=g[g.length-1];for(k=0;k<g.length;k+=1)ye(g[k],x,r);for(k=0;k<b.length;k+=1)d.delete(b[k]);F(a,O.prev,R.next),F(a,f,O),F(a,R,x),s=x,f=R,u-=1,g=[],b=[]}else d.delete(o),ye(o,s,r),F(a,o.prev,o.next),F(a,o,f===null?a.first:f.next),F(a,f,o),f=o;continue}for(g=[],b=[];s!==null&&s.k!==y;)(s.e.f&oe)===0&&(d??(d=new Set)).add(s),b.push(s),s=s.next;if(s===null)continue;o=s}g.push(o),f=o,s=o.next}if(s!==null||d!==void 0){for(var P=d===void 0?[]:Se(d);s!==null;)(s.e.f&oe)===0&&P.push(s),s=s.next;var q=P.length;if(q>0){var m=(t&Ee)!==0&&A===0?r:null;if(v){for(u=0;u<q;u+=1)(D=P[u].a)==null||D.measure();for(u=0;u<q;u+=1)(B=P[u].a)==null||B.fix()}_a(a,P,m,p)}}v&&je(()=>{var Q;if(c!==void 0)for(o of c)(Q=o.a)==null||Q.apply()}),ge.first=a.first&&a.first.e,ge.last=f&&f.e}function ma(e,a,r,n){(n&de)!==0&&he(e.v,a),(n&_e)!==0?he(e.i,r):e.i=r}function Me(e,a,r,n,t,l,i,v,S,A){var p=(S&de)!==0,_=(S&Ge)===0,s=p?_?W(t):ve(t):t,d=(S&_e)===0?i:ve(i),f={i:d,v:s,k:l,a:null,e:null,prev:r,next:n};try{return f.e=Ie(()=>v(e,s,d,A),H),f.e.prev=r&&r.e,f.e.next=n&&n.e,r===null?a.first=f:(r.next=f,r.e.next=f.e),n!==null&&(n.prev=f,n.e.prev=f.e),f}finally{}}function ye(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,l=e.e.nodes_start;l!==n;){var i=Ue(l);t.before(l),l=i}}function F(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const pa=Symbol("is custom element"),ga=Symbol("is html");function K(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;Ae(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var t=e.checked;Ae(e,"checked",null),e.checked=t}}};e.__on_r=r,Ze(r),sa()}}function Ae(e,a,r,n){var t=ha(e);H&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[Qe]=r),e.removeAttribute(a))}function ha(e){return e.__attributes??(e.__attributes={[pa]:e.nodeName.includes("-"),[ga]:e.namespaceURI===We})}function z(e,a,r=a){var n=ea();Te(e,"input",t=>{var l=t?e.defaultValue:e.value;if(l=fe(e)?ue(l):l,r(l),n&&l!==(l=a())){var i=e.selectionStart,v=e.selectionEnd;e.value=l??"",v!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(v,e.value.length))}}),(H&&e.defaultValue!==e.value||aa(a)==null&&e.value)&&r(fe(e)?ue(e.value):e.value),ra(()=>{var t=a();fe(e)&&t===ue(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function fe(e){var a=e.type;return a==="number"||a==="range"}function ue(e){return e===""?null:+e}function Ne(e,a,r){if(e.multiple)return ba(e,a);for(var n of e.options){var t=Z(n);if(ta(t,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ya(e,a){we(()=>{var r=new MutationObserver(()=>{var n=e.__value;Ne(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Aa(e,a,r=a){var n=!0;Te(e,"change",t=>{var l=t?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(l),Z);else{var v=e.querySelector(l)??e.querySelector("option:not([disabled])");i=v&&Z(v)}r(i)}),we(()=>{var t=a();if(Ne(e,t,n),n&&t===void 0){var l=e.querySelector(":checked");l!==null&&(t=Z(l),r(t))}e.__value=t,n=!1}),ya(e)}function ba(e,a){for(var r of e.options)r.selected=~a.indexOf(Z(r))}function Z(e){return"__value"in e?e.__value:e.value}function ka(e){var a=ve(0);return function(){return arguments.length===1?(N(a,h(a)+1),arguments[0]):(h(a),e())}}const me="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",U=te({value:localStorage.getItem("api_key")??""});var G=ka(()=>U),Ia=M("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Sa=M("<p>Laddar lagersaldo...</p>"),Ea=M('<p style="color: red;"> </p>'),wa=M("<th> </th>"),xa=M("<td> </td>"),La=M("<tr></tr>"),Ta=M("<table><thead><tr></tr></thead><tbody></tbody></table>"),Ma=M("<p>Inget saldo tillgängligt.</p>"),Na=M("<h2>Lagersaldo</h2> <!>",1);function Ca(e,a){xe(a,!1);let r=W([]),n=W(!1),t=W(null);async function l(){N(n,!0),N(t,null);try{console.log("Hämtar lagersaldo med nyckel:",G().value);const _=await fetch(`${me}?key=${G().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",_),!_.ok)throw new Error(`Fel vid hämtning: ${_.status}`);const s=await _.json();console.log("JSON-data från lagersaldo-API:",s),N(r,Array.isArray(s.saldo)?s.saldo:[])}catch(_){console.error("Fel vid hämtning av lagersaldo:",_),N(t,_.message)}finally{N(n,!1)}}function i(){const _=prompt("Ange din API-nyckel:");_&&G(G().value=_)}na(()=>G(),()=>{G().value&&l()}),la(),ua();var v=Na(),S=w(ne(v),2);{var A=_=>{var s=Ia(),d=w(ne(s),2);oa("click",d,i),T(_,s)},p=(_,s)=>{{var d=c=>{var g=Sa();T(c,g)},f=(c,g)=>{{var b=y=>{var o=Ea(),u=V(o,!0);C(o),j(()=>X(u,h(t))),T(y,o)},E=(y,o)=>{{var u=x=>{var k=Ta(),O=V(k),R=V(O);re(R,5,()=>Object.keys(h(r)[0]),ae,(q,m)=>{var I=wa(),L=V(I,!0);C(I),j(()=>X(L,h(m))),T(q,I)}),C(R),C(O);var P=w(O);re(P,5,()=>h(r),ae,(q,m)=>{var I=La();re(I,5,()=>Object.values(h(m)),ae,(L,D)=>{var B=xa(),Q=V(B,!0);C(B),j(()=>X(Q,h(D))),T(L,B)}),C(I),T(q,I)}),C(P),C(k),T(x,k)},J=x=>{var k=Ma();T(x,k)};Y(y,x=>{Array.isArray(h(r))&&h(r).length>0?x(u):x(J,!1)},o)}};Y(c,y=>{h(t)?y(b):y(E,!1)},g)}};Y(_,c=>{h(n)?c(d):c(f,!1)},s)}};Y(S,_=>{G().value?_(p,!1):_(A)})}T(e,v),Le()}let le=ce(te([])),Oa={getMaterialList:()=>(h(le).length===0&&Pa(),h(le))};async function Pa(){try{console.log("Hämtar material med nyckel:",U.value);const a=await(await fetch(`${me}?key=${U.value}&action=material`)).json();console.log("API-svar material:",a),N(le,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(le,[],!0)}}var Ha=M("<option> </option>"),Ra=M("<pre> </pre>"),qa=M('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Da=M("<p>Laddar material eller saknar API-nyckel...</p>"),Ba=M('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Ga(e,a){xe(a,!0);let r=te(Oa.getMaterialList()),n=ce(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},l=ce(te(U.value||""));ia(()=>{console.log(ca(r))});function i(){console.log("Sparar API-nyckel:",h(l)),U.value=h(l)}async function v(){N(n,null);try{console.log("Skickar bokning med nyckel:",U.value);const g=await(await fetch(`${me}?key=${U.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",g),N(n,g,!0)}catch(c){console.error("Fel vid bokning:",c),N(n,{error:c instanceof Error?c.message:String(c)},!0)}}var S=Ba(),A=w(ne(S),2);K(A);var p=w(A,2);p.__click=i;var _=w(p,2);{var s=c=>{var g=qa(),b=ne(g),E=V(b);E.value=E.__value="";var y=w(E);re(y,17,()=>r,ae,(m,I)=>{var L=Ha(),D={},B=V(L,!0);C(L),j(()=>{D!==(D=h(I).MaterialId)&&(L.value=(L.__value=h(I).MaterialId)??""),X(B,h(I).Namn)}),T(m,L)}),C(b);var o=w(b,2);K(o);var u=w(o,2);K(u);var J=w(u,2);K(J);var x=w(J,4);K(x);var k=w(x,2);K(k);var O=w(k,2);K(O);var R=w(O,2);R.__click=v;var P=w(R,2);{var q=m=>{var I=Ra(),L=V(I);C(I),j(D=>X(L,`ban ${D??""} an`),[()=>JSON.stringify(h(n),null,2)]),T(m,I)};Y(P,m=>{h(n)&&m(q)})}Aa(b,()=>t.materialId,m=>t.materialId=m),z(o,()=>t.antal,m=>t.antal=m),z(u,()=>t.från,m=>t.från=m),z(J,()=>t.till,m=>t.till=m),z(x,()=>t.ansvarig.namn,m=>t.ansvarig.namn=m),z(k,()=>t.ansvarig.epost,m=>t.ansvarig.epost=m),z(O,()=>t.ansvarig.telefonnummer,m=>t.ansvarig.telefonnummer=m),T(c,g)},d=c=>{var g=Da();T(c,g)};Y(_,c=>{Array.isArray(r)&&r.length>0?c(s):c(d,!1)})}var f=w(_,2);Ca(f,{}),z(A,()=>h(l),c=>N(l,c)),T(e,S),Le()}fa(["click"]);export{Ga as component};
