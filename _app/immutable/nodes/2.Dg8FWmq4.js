import{t as O,a as M}from"../chunks/BlccSK2Q.js";import{i as Ke}from"../chunks/CNjbfXTh.js";import{h as K,d as Re,b as qe,o,a6 as ge,r as De,e as Pe,f as _e,s as ne,g as le,k as j,a0 as Ue,i as ye,j as be,p as Be,a4 as ke,X as Fe,m as Y,a7 as ce,a8 as se,Q as de,a9 as ve,aa as pe,ab as Ve,a3 as Je,ac as Ye,D as Ge,ad as ue,ae as Qe,_ as Xe,O as je,N as We,af as Ae,Y as Ze,ag as ze,ah as ea,ai as aa,aj as ra,ak as ta,a as na,al as la,am as Ie,an as sa,G as Ee,ao as Se,ap as xe,M as E,F as re,J as Te,v as U,K as B,L as $,I as X,aq as ia,ar as F}from"../chunks/DX3K2HII.js";import{a as oa,l as we,e as Ne,s as W}from"../chunks/CnsorDfL.js";import{i as Q,s as Le,a as Me,b as fa}from"../chunks/BXXhmYsE.js";import{w as va}from"../chunks/Deb-V3KV.js";function ee(e,a){return a}function ua(e,a,r,i){for(var t=[],s=a.length,f=0;f<s;f++)Ve(a[f].e,t,!0);var l=s>0&&t.length===0&&r!==null;if(l){var S=r.parentNode;Je(S),S.append(r),i.clear(),P(e,a[0].prev,a[s-1].next)}Ye(t,()=>{for(var k=0;k<s;k++){var p=a[k];l||(i.delete(p.k),P(e,p.prev,p.next)),Ge(p.e,!l)}})}function ae(e,a,r,i,t,s=null){var f=e,l={flags:a,items:new Map,first:null},S=(a&Ae)!==0;if(S){var k=e;f=K?ne(je(k)):k.appendChild(We())}K&&Re();var p=null,C=!1,v=ge(()=>{var h=r();return Fe(h)?h:h==null?[]:ke(h)});qe(()=>{var h=o(v),n=h.length;if(C&&n===0)return;C=n===0;let b=!1;if(K){var c=De(f)===Pe;c!==(n===0)&&(f=_e(),ne(f),le(!1),b=!0)}if(K){for(var y=null,m,g=0;g<n;g++){if(j.nodeType===8&&j.data===Ue){f=j,b=!0,le(!1);break}var u=h[g],_=i(u,g);m=Oe(j,l,y,null,u,_,g,t,a,r),l.items.set(_,m),y=m}n>0&&ne(_e())}K||_a(h,l,f,t,a,i,r),s!==null&&(n===0?p?ye(p):p=be(()=>s(f)):p!==null&&Be(p,()=>{p=null})),b&&le(!0),o(v)}),K&&(f=j)}function _a(e,a,r,i,t,s,f){var d,N,L,I;var l=(t&ze)!==0,S=(t&(ue|ve))!==0,k=e.length,p=a.items,C=a.first,v=C,h,n=null,b,c=[],y=[],m,g,u,_;if(l)for(_=0;_<k;_+=1)m=e[_],g=s(m,_),u=p.get(g),u!==void 0&&((d=u.a)==null||d.measure(),(b??(b=new Set)).add(u));for(_=0;_<k;_+=1){if(m=e[_],g=s(m,_),u=p.get(g),u===void 0){var H=v?v.e.nodes_start:r;n=Oe(H,a,n,n===null?a.first:n.next,m,g,_,i,t,f),p.set(g,n),c=[],y=[],v=n.next;continue}if(S&&ca(u,m,_,t),(u.e.f&se)!==0&&(ye(u.e),l&&((N=u.a)==null||N.unfix(),(b??(b=new Set)).delete(u))),u!==v){if(h!==void 0&&h.has(u)){if(c.length<y.length){var x=y[0],A;n=x.prev;var q=c[0],T=c[c.length-1];for(A=0;A<c.length;A+=1)he(c[A],x,r);for(A=0;A<y.length;A+=1)h.delete(y[A]);P(a,q.prev,T.next),P(a,n,q),P(a,T,x),v=x,n=T,_-=1,c=[],y=[]}else h.delete(u),he(u,v,r),P(a,u.prev,u.next),P(a,u,n===null?a.first:n.next),P(a,n,u),n=u;continue}for(c=[],y=[];v!==null&&v.k!==g;)(v.e.f&se)===0&&(h??(h=new Set)).add(v),y.push(v),v=v.next;if(v===null)continue;u=v}c.push(u),n=u,v=u.next}if(v!==null||h!==void 0){for(var w=h===void 0?[]:ke(h);v!==null;)(v.e.f&se)===0&&w.push(v),v=v.next;var R=w.length;if(R>0){var G=(t&Ae)!==0&&k===0?r:null;if(l){for(_=0;_<R;_+=1)(L=w[_].a)==null||L.measure();for(_=0;_<R;_+=1)(I=w[_].a)==null||I.fix()}ua(a,w,G,p)}}l&&Ze(()=>{var D;if(b!==void 0)for(u of b)(D=u.a)==null||D.apply()}),de.first=a.first&&a.first.e,de.last=n&&n.e}function ca(e,a,r,i){(i&ue)!==0&&pe(e.v,a),(i&ve)!==0?pe(e.i,r):e.i=r}function Oe(e,a,r,i,t,s,f,l,S,k){var p=(S&ue)!==0,C=(S&Qe)===0,v=p?C?Y(t):ce(t):t,h=(S&ve)===0?f:ce(f),n={i:h,v,k:s,a:null,e:null,prev:r,next:i};try{return n.e=be(()=>l(e,v,h,k),K),n.e.prev=r&&r.e,n.e.next=i&&i.e,r===null?a.first=n:(r.next=n,r.e.next=n.e),i!==null&&(i.prev=n,i.e.prev=n.e),n}finally{}}function he(e,a,r){for(var i=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,s=e.e.nodes_start;s!==i;){var f=Xe(s);t.before(s),s=f}}function P(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const da=Symbol("is custom element"),pa=Symbol("is html");function V(e){if(K){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var i=e.value;me(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var t=e.checked;me(e,"checked",null),e.checked=t}}};e.__on_r=r,ea(r),oa()}}function me(e,a,r,i){var t=ha(e);K&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[aa]=r),e.removeAttribute(a))}function ha(e){return e.__attributes??(e.__attributes={[da]:e.nodeName.includes("-"),[pa]:e.namespaceURI===ra})}function J(e,a,r=a){var i=ta();we(e,"input",t=>{var s=t?e.defaultValue:e.value;if(s=ie(e)?oe(s):s,r(s),i&&s!==(s=a())){var f=e.selectionStart,l=e.selectionEnd;e.value=s??"",l!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(l,e.value.length))}}),(K&&e.defaultValue!==e.value||na(a)==null&&e.value)&&r(ie(e)?oe(e.value):e.value),la(()=>{var t=a();ie(e)&&t===oe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function ie(e){var a=e.type;return a==="number"||a==="range"}function oe(e){return e===""?null:+e}function Ce(e,a,r){if(e.multiple)return ya(e,a);for(var i of e.options){var t=Z(i);if(sa(t,a)){i.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ma(e,a){Ie(()=>{var r=new MutationObserver(()=>{var i=e.__value;Ce(e,i)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ga(e,a,r=a){var i=!0;we(e,"change",t=>{var s=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(s),Z);else{var l=e.querySelector(s)??e.querySelector("option:not([disabled])");f=l&&Z(l)}r(f)}),Ie(()=>{var t=a();if(Ce(e,t,i),i&&t===void 0){var s=e.querySelector(":checked");s!==null&&(t=Z(s),r(t))}e.__value=t,i=!1}),ma(e)}function ya(e,a){for(var r of e.options)r.selected=~a.indexOf(Z(r))}function Z(e){return"__value"in e?e.__value:e.value}const fe="https://script.google.com/macros/s/AKfycbx37QQFI7hnNU6Hv4E2AsZHBm4CO0u2uWko42K6grUJoEI4vI7krWXa1GxEADLZjH9x/exec",ba=localStorage.getItem("api_key"),z=va(ba);z.subscribe(e=>{localStorage.setItem("api_key",e||"")});var ka=O("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Aa=O("<p>Laddar lagersaldo...</p>"),Ia=O('<p style="color: red;"> </p>'),Ea=O("<th> </th>"),Sa=O("<td> </td>"),xa=O("<tr></tr>"),Ta=O("<table><thead><tr></tr></thead><tbody></tbody></table>"),wa=O("<p>Inget saldo tillgängligt.</p>"),Na=O("<h2>Lagersaldo</h2> <!>",1);function La(e,a){Ee(a,!1);const[r,i]=Le(),t=()=>Me(z,"$apiKey",r);let s=Y([]),f=Y(!1),l=Y(null);async function S(){U(f,!0),U(l,null);try{const n=await fetch(`${fe}?key=${t()}&type=saldo`);if(!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const b=await n.json();U(s,b.saldo)}catch(n){U(l,n.message)}finally{U(f,!1)}}function k(){const n=prompt("Ange din API-nyckel:");n&&z.set(n)}Se(()=>t(),()=>{t()&&S()}),xe(),Ke();var p=Na(),C=E(re(p),2);{var v=n=>{var b=ka(),c=E(re(b),2);Ne("click",c,k),M(n,b)},h=(n,b)=>{{var c=m=>{var g=Aa();M(m,g)},y=(m,g)=>{{var u=H=>{var x=Ia(),A=B(x,!0);$(x),X(()=>W(A,o(l))),M(H,x)},_=(H,x)=>{{var A=T=>{var w=Ta(),R=B(w),G=B(R);ae(G,5,()=>Object.keys(o(s)[0]),ee,(N,L)=>{var I=Ea(),D=B(I,!0);$(I),X(()=>W(D,o(L))),M(N,I)}),$(G),$(R);var d=E(R);ae(d,5,()=>o(s),ee,(N,L)=>{var I=xa();ae(I,5,()=>Object.values(o(L)),ee,(D,He)=>{var te=Sa(),$e=B(te,!0);$(te),X(()=>W($e,o(He))),M(D,te)}),$(I),M(N,I)}),$(d),$(w),M(T,w)},q=T=>{var w=wa();M(T,w)};Q(H,T=>{o(s).length?T(A):T(q,!1)},x)}};Q(m,H=>{o(l)?H(u):H(_,!1)},g)}};Q(n,m=>{o(f)?m(c):m(y,!1)},b)}};Q(C,n=>{t()?n(h,!1):n(v)})}M(e,p),Te(),i()}var Ma=O("<option> </option>"),Oa=O("<pre> </pre>"),Ca=O('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ha=O("<p>Laddar material eller saknar API-nyckel...</p>"),$a=O('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <!> <!>',1);function Ba(e,a){Ee(a,!1);const[r,i]=Le(),t=()=>Me(z,"$apiKey",r);let s=Y([]),f=Y(null),l=Y({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}});async function S(){const y=await(await fetch(`${fe}?key=${t()}`)).json();U(s,y.material)}async function k(){U(f,null);const c=await fetch(`${fe}?key=${t()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(o(l))});U(f,await c.json())}Se(()=>t(),()=>{t()&&S()}),xe();var p=$a(),C=E(re(p),2);V(C);var v=E(C,2);{var h=c=>{var y=Ca(),m=re(y);X(()=>{o(l),ia(()=>{o(s)})});var g=B(m);g.value=g.__value="";var u=E(g);ae(u,1,()=>o(s),ee,(d,N)=>{var L=Ma(),I={},D=B(L,!0);$(L),X(()=>{I!==(I=o(N).MaterialId)&&(L.value=(L.__value=o(N).MaterialId)??""),W(D,o(N).Namn)}),M(d,L)}),$(m);var _=E(m,2);V(_);var H=E(_,2);V(H);var x=E(H,2);V(x);var A=E(x,4);V(A);var q=E(A,2);V(q);var T=E(q,2);V(T);var w=E(T,2),R=E(w,2);{var G=d=>{var N=Oa(),L=B(N,!0);$(N),X(I=>W(L,I),[()=>JSON.stringify(o(f),null,2)],ge),M(d,N)};Q(R,d=>{o(f)&&d(G)})}ga(m,()=>o(l).materialId,d=>F(l,o(l).materialId=d)),J(_,()=>o(l).antal,d=>F(l,o(l).antal=d)),J(H,()=>o(l).från,d=>F(l,o(l).från=d)),J(x,()=>o(l).till,d=>F(l,o(l).till=d)),J(A,()=>o(l).ansvarig.namn,d=>F(l,o(l).ansvarig.namn=d)),J(q,()=>o(l).ansvarig.epost,d=>F(l,o(l).ansvarig.epost=d)),J(T,()=>o(l).ansvarig.telefonnummer,d=>F(l,o(l).ansvarig.telefonnummer=d)),Ne("click",w,k),M(c,y)},n=c=>{var y=Ha();M(c,y)};Q(v,c=>{o(s).length>0?c(h):c(n,!1)})}var b=E(v,2);La(b,{}),J(C,t,c=>fa(z,c)),M(e,p),Te(),i()}export{Ba as component};
