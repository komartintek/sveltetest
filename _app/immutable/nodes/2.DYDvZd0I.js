import{t as w,a as T}from"../chunks/6gE4WjDV.js";import{h as H,a as Ce,b as Oe,q as h,a9 as Pe,r as He,c as Re,d as me,s as ne,e as le,i as $,Z as qe,f as be,g as Ie,p as De,a1 as Se,R as Be,ae as W,ao as fe,ap as ie,L as ge,aq as de,ar as ye,as as Fe,a0 as Ve,at as Ke,y as ze,au as _e,av as Je,X as Ue,J as Ye,I as Ge,aw as Ee,V as $e,ax as Xe,ay as Ze,az as je,aA as Qe,aB as We,k as ea,a4 as aa,a3 as Le,aC as ra,ad as N,ac as pe,A as xe,aD as ta,aE as na,G as E,z as re,C as Te,D as B,F as O,B as X,al as ce,u as la}from"../chunks/BIZTmQUP.js";import{a as ia,l as we,e as sa,s as Z,d as oa}from"../chunks/DdpKz3ms.js";import{i as G}from"../chunks/CYQ14GS-.js";import{i as ua}from"../chunks/win48-2-.js";function ee(e,a){return a}function va(e,a,r,t){for(var n=[],o=a.length,v=0;v<o;v++)Fe(a[v].e,n,!0);var c=o>0&&n.length===0&&r!==null;if(c){var S=r.parentNode;Ve(S),S.append(r),t.clear(),D(e,a[0].prev,a[o-1].next)}Ke(n,()=>{for(var b=0;b<o;b++){var m=a[b];c||(t.delete(m.k),D(e,m.prev,m.next)),ze(m.e,!c)}})}function ae(e,a,r,t,n,o=null){var v=e,c={flags:a,items:new Map,first:null},S=(a&Ee)!==0;if(S){var b=e;v=H?ne(Ye(b)):b.appendChild(Ge())}H&&Ce();var m=null,d=!1,i=Pe(()=>{var _=r();return Be(_)?_:_==null?[]:Se(_)});Oe(()=>{var _=h(i),l=_.length;if(d&&l===0)return;d=l===0;let g=!1;if(H){var y=He(v)===Re;y!==(l===0)&&(v=me(),ne(v),le(!1),g=!0)}if(H){for(var I=null,x,p=0;p<l;p++){if($.nodeType===8&&$.data===qe){v=$,g=!0,le(!1);break}var s=_[p],u=t(s,p);x=Me($,c,I,null,s,u,p,n,a,r),c.items.set(u,x),I=x}l>0&&ne(me())}H||fa(_,c,v,n,a,t,r),o!==null&&(l===0?m?be(m):m=Ie(()=>o(v)):m!==null&&De(m,()=>{m=null})),g&&le(!0),h(i)}),H&&(v=$)}function fa(e,a,r,t,n,o,v){var k,C,U,Y;var c=(n&Xe)!==0,S=(n&(_e|de))!==0,b=e.length,m=a.items,d=a.first,i=d,_,l=null,g,y=[],I=[],x,p,s,u;if(c)for(u=0;u<b;u+=1)x=e[u],p=o(x,u),s=m.get(p),s!==void 0&&((k=s.a)==null||k.measure(),(g??(g=new Set)).add(s));for(u=0;u<b;u+=1){if(x=e[u],p=o(x,u),s=m.get(p),s===void 0){var F=i?i.e.nodes_start:r;l=Me(F,a,l,l===null?a.first:l.next,x,p,u,t,n,v),m.set(p,l),y=[],I=[],i=l.next;continue}if(S&&ca(s,x,u,n),(s.e.f&ie)!==0&&(be(s.e),c&&((C=s.a)==null||C.unfix(),(g??(g=new Set)).delete(s))),s!==i){if(_!==void 0&&_.has(s)){if(y.length<I.length){var L=I[0],A;l=L.prev;var R=y[0],q=y[y.length-1];for(A=0;A<y.length;A+=1)Ae(y[A],L,r);for(A=0;A<I.length;A+=1)_.delete(I[A]);D(a,R.prev,q.next),D(a,l,R),D(a,q,L),i=L,l=q,u-=1,y=[],I=[]}else _.delete(s),Ae(s,i,r),D(a,s.prev,s.next),D(a,s,l===null?a.first:l.next),D(a,l,s),l=s;continue}for(y=[],I=[];i!==null&&i.k!==p;)(i.e.f&ie)===0&&(_??(_=new Set)).add(i),I.push(i),i=i.next;if(i===null)continue;s=i}y.push(s),l=s,i=s.next}if(i!==null||_!==void 0){for(var P=_===void 0?[]:Se(_);i!==null;)(i.e.f&ie)===0&&P.push(i),i=i.next;var f=P.length;if(f>0){var M=(n&Ee)!==0&&b===0?r:null;if(c){for(u=0;u<f;u+=1)(U=P[u].a)==null||U.measure();for(u=0;u<f;u+=1)(Y=P[u].a)==null||Y.fix()}va(a,P,M,m)}}c&&$e(()=>{var Q;if(g!==void 0)for(s of g)(Q=s.a)==null||Q.apply()}),ge.first=a.first&&a.first.e,ge.last=l&&l.e}function ca(e,a,r,t){(t&_e)!==0&&ye(e.v,a),(t&de)!==0?ye(e.i,r):e.i=r}function Me(e,a,r,t,n,o,v,c,S,b){var m=(S&_e)!==0,d=(S&Je)===0,i=m?d?W(n):fe(n):n,_=(S&de)===0?v:fe(v),l={i:_,v:i,k:o,a:null,e:null,prev:r,next:t};try{return l.e=Ie(()=>c(e,i,_,b),H),l.e.prev=r&&r.e,l.e.next=t&&t.e,r===null?a.first=l:(r.next=l,r.e.next=l.e),t!==null&&(t.prev=l,t.e.prev=l.e),l}finally{}}function Ae(e,a,r){for(var t=e.next?e.next.e.nodes_start:r,n=a?a.e.nodes_start:r,o=e.e.nodes_start;o!==t;){var v=Ue(o);n.before(o),o=v}}function D(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const da=Symbol("is custom element"),_a=Symbol("is html");function V(e){if(H){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var t=e.value;ke(e,"value",null),e.value=t}if(e.hasAttribute("checked")){var n=e.checked;ke(e,"checked",null),e.checked=n}}};e.__on_r=r,Ze(r),ia()}}function ke(e,a,r,t){var n=pa(e);H&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=r)&&(a==="loading"&&(e[je]=r),e.removeAttribute(a))}function pa(e){return e.__attributes??(e.__attributes={[da]:e.nodeName.includes("-"),[_a]:e.namespaceURI===Qe})}function K(e,a,r=a){var t=We();we(e,"input",n=>{var o=n?e.defaultValue:e.value;if(o=se(e)?oe(o):o,r(o),t&&o!==(o=a())){var v=e.selectionStart,c=e.selectionEnd;e.value=o??"",c!==null&&(e.selectionStart=v,e.selectionEnd=Math.min(c,e.value.length))}}),(H&&e.defaultValue!==e.value||ea(a)==null&&e.value)&&r(se(e)?oe(e.value):e.value),aa(()=>{var n=a();se(e)&&n===oe(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function se(e){var a=e.type;return a==="number"||a==="range"}function oe(e){return e===""?null:+e}function Ne(e,a,r){if(e.multiple)return ga(e,a);for(var t of e.options){var n=j(t);if(ra(n,a)){t.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ha(e,a){Le(()=>{var r=new MutationObserver(()=>{var t=e.__value;Ne(e,t)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ma(e,a,r=a){var t=!0;we(e,"change",n=>{var o=n?"[selected]":":checked",v;if(e.multiple)v=[].map.call(e.querySelectorAll(o),j);else{var c=e.querySelector(o)??e.querySelector("option:not([disabled])");v=c&&j(c)}r(v)}),Le(()=>{var n=a();if(Ne(e,n,t),t&&n===void 0){var o=e.querySelector(":checked");o!==null&&(n=j(o),r(n))}e.__value=n,t=!1}),ha(e)}function ga(e,a){for(var r of e.options)r.selected=~a.indexOf(j(r))}function j(e){return"__value"in e?e.__value:e.value}function ya(e){var a=fe(0);return function(){return arguments.length===1?(N(a,h(a)+1),arguments[0]):(h(a),e())}}const he="https://script.google.com/macros/s/AKfycbwC1aJn1z8L6O6eHl_4W0Bptl57VVGAhECguYnnz6myvSpuB5jIzaZ2IQ575ALvpwrL/exec",J=pe({value:localStorage.getItem("api_key")??""});var z=ya(()=>J),Aa=w("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),ka=w("<p>Laddar lagersaldo...</p>"),ba=w('<p style="color: red;"> </p>'),Ia=w("<th> </th>"),Sa=w("<td> </td>"),Ea=w("<tr></tr>"),La=w("<table><thead><tr></tr></thead><tbody></tbody></table>"),xa=w("<p>Inget saldo tillgängligt.</p>"),Ta=w("<h2>Lagersaldo</h2> <!>",1);function wa(e,a){xe(a,!1);let r=W([]),t=W(!1),n=W(null);async function o(){N(t,!0),N(n,null);try{console.log("Hämtar lagersaldo med nyckel:",z().value);const d=await fetch(`${he}?key=${z().value}&action=lagersaldo`);if(console.log("Svar från lagersaldo-API:",d),!d.ok)throw new Error(`Fel vid hämtning: ${d.status}`);const i=await d.json();console.log("JSON-data från lagersaldo-API:",i),N(r,Array.isArray(i.saldo)?i.saldo:[])}catch(d){console.error("Fel vid hämtning av lagersaldo:",d),N(n,d.message)}finally{N(t,!1)}}function v(){const d=prompt("Ange din API-nyckel:");d&&z(z().value=d)}ta(()=>z(),()=>{z().value&&o()}),na(),ua();var c=Ta(),S=E(re(c),2);{var b=d=>{var i=Aa(),_=E(re(i),2);sa("click",_,v),T(d,i)},m=(d,i)=>{{var _=g=>{var y=ka();T(g,y)},l=(g,y)=>{{var I=p=>{var s=ba(),u=B(s,!0);O(s),X(()=>Z(u,h(n))),T(p,s)},x=(p,s)=>{{var u=L=>{var A=La(),R=B(A),q=B(R);ae(q,5,()=>Object.keys(h(r)[0]),ee,(f,M)=>{var k=Ia(),C=B(k,!0);O(k),X(()=>Z(C,h(M))),T(f,k)}),O(q),O(R);var P=E(R);ae(P,5,()=>h(r),ee,(f,M)=>{var k=Ea();ae(k,5,()=>Object.values(h(M)),ee,(C,U)=>{var Y=Sa(),Q=B(Y,!0);O(Y),X(()=>Z(Q,h(U))),T(C,Y)}),O(k),T(f,k)}),O(P),O(A),T(L,A)},F=L=>{var A=xa();T(L,A)};G(p,L=>{Array.isArray(h(r))&&h(r).length>0?L(u):L(F,!1)},s)}};G(g,p=>{h(n)?p(I):p(x,!1)},y)}};G(d,g=>{h(t)?g(_):g(l,!1)},i)}};G(S,d=>{z().value?d(m,!1):d(b)})}T(e,c),Te()}let te=ce(pe([])),ue=!1,ve={getMaterialList:()=>(!ue&&h(te).length===0&&(Ma(),ue=!0,setTimeout(()=>{ue=!1},1e3)),h(te))};async function Ma(){try{console.log("Hämtar material med nyckel:",J.value);const a=await(await fetch(`${he}?key=${J.value}&action=material`)).json();console.log("API-svar material:",a),N(te,Array.isArray(a.material)?a.material:[],!0)}catch(e){console.error("Fel vid hämtning av material:",e),N(te,[],!0)}}var Na=w("<option> </option>"),Ca=w("<pre> </pre>"),Oa=w('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Pa=w("<p>Laddar material eller saknar API-nyckel...</p>"),Ha=w('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Va(e,a){xe(a,!0);let r=ce(null),t={materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}},n=ce(pe(J.value||""));la(()=>{});function o(){console.log("Sparar API-nyckel:",h(n)),J.value=h(n)}async function v(){N(r,null);try{console.log("Skickar bokning med nyckel:",J.value);const g=await(await fetch(`${he}?key=${J.value}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)})).json();console.log("API-svar bokning:",g),N(r,g,!0)}catch(l){console.error("Fel vid bokning:",l),N(r,{error:l instanceof Error?l.message:String(l)},!0)}}var c=Ha(),S=E(re(c),2);V(S);var b=E(S,2);b.__click=o;var m=E(b,2);{var d=l=>{var g=Oa(),y=re(g),I=B(y);I.value=I.__value="";var x=E(I);ae(x,17,()=>ve.getMaterialList(),ee,(f,M)=>{var k=Na(),C={},U=B(k,!0);O(k),X(()=>{C!==(C=h(M).MaterialId)&&(k.value=(k.__value=h(M).MaterialId)??""),Z(U,h(M).Namn)}),T(f,k)}),O(y);var p=E(y,2);V(p);var s=E(p,2);V(s);var u=E(s,2);V(u);var F=E(u,4);V(F);var L=E(F,2);V(L);var A=E(L,2);V(A);var R=E(A,2);R.__click=v;var q=E(R,2);{var P=f=>{var M=Ca(),k=B(M);O(M),X(C=>Z(k,`ban ${C??""} an`),[()=>JSON.stringify(h(r),null,2)]),T(f,M)};G(q,f=>{h(r)&&f(P)})}ma(y,()=>t.materialId,f=>t.materialId=f),K(p,()=>t.antal,f=>t.antal=f),K(s,()=>t.från,f=>t.från=f),K(u,()=>t.till,f=>t.till=f),K(F,()=>t.ansvarig.namn,f=>t.ansvarig.namn=f),K(L,()=>t.ansvarig.epost,f=>t.ansvarig.epost=f),K(A,()=>t.ansvarig.telefonnummer,f=>t.ansvarig.telefonnummer=f),T(l,g)},i=l=>{var g=Pa();T(l,g)};G(m,l=>{Array.isArray(ve.getMaterialList())&&ve.getMaterialList().length>0?l(d):l(i,!1)})}var _=E(m,2);wa(_,{}),K(S,()=>h(n),l=>N(n,l)),T(e,c),Te()}oa(["click"]);export{Va as component};
