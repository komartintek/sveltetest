import{t as N,a as w}from"../chunks/i4SAYe-U.js";import{i as Ae}from"../chunks/CS5ISnyU.js";import{h as K,d as Re,b as qe,o,a6 as ke,r as De,e as Pe,f as pe,s as ie,g as se,k as Z,a0 as Ue,i as Ie,j as Ee,p as Be,a4 as Se,Y as Fe,m as Y,a7 as he,a8 as oe,Q as me,a9 as _e,aa as ye,ab as Ve,a3 as Je,ac as Ye,D as Ge,ad as de,ae as Qe,_ as Xe,O as je,N as We,af as xe,X as Ze,ag as ze,ah as ea,ai as aa,aj as ra,ak as ta,a as na,al as la,am as Te,an as ia,G as we,ao as Ne,ap as Le,M as I,F as ne,J as Me,v as R,K as J,L as C,I as W,aq as sa,ar as G}from"../chunks/DZVzPhGv.js";import{a as oa,l as Oe,e as ue,s as z}from"../chunks/mH8pkYhF.js";import{i as j,s as Ce,a as He}from"../chunks/DOuXPHa7.js";import{w as va}from"../chunks/DgQpC51A.js";function re(e,a){return a}function fa(e,a,r,v){for(var t=[],i=a.length,f=0;f<i;f++)Ve(a[f].e,t,!0);var l=i>0&&t.length===0&&r!==null;if(l){var A=r.parentNode;Je(A),A.append(r),v.clear(),V(e,a[0].prev,a[i-1].next)}Ye(t,()=>{for(var b=0;b<i;b++){var h=a[b];l||(v.delete(h.k),V(e,h.prev,h.next)),Ge(h.e,!l)}})}function te(e,a,r,v,t,i=null){var f=e,l={flags:a,items:new Map,first:null},A=(a&xe)!==0;if(A){var b=e;f=K?ie(je(b)):b.appendChild(We())}K&&Re();var h=null,H=!1,u=ke(()=>{var p=r();return Fe(p)?p:p==null?[]:Se(p)});qe(()=>{var p=o(u),n=p.length;if(H&&n===0)return;H=n===0;let m=!1;if(K){var g=De(f)===Pe;g!==(n===0)&&(f=pe(),ie(f),se(!1),m=!0)}if(K){for(var E=null,y,d=0;d<n;d++){if(Z.nodeType===8&&Z.data===Ue){f=Z,m=!0,se(!1);break}var s=p[d],c=v(s,d);y=Ke(Z,l,E,null,s,c,d,t,a,r),l.items.set(c,y),E=y}n>0&&ie(pe())}K||ua(p,l,f,t,a,v,r),i!==null&&(n===0?h?Ie(h):h=Ee(()=>i(f)):h!==null&&Be(h,()=>{h=null})),m&&se(!0),o(u)}),K&&(f=Z)}function ua(e,a,r,v,t,i,f){var P,U,B,_;var l=(t&ze)!==0,A=(t&(de|_e))!==0,b=e.length,h=a.items,H=a.first,u=H,p,n=null,m,g=[],E=[],y,d,s,c;if(l)for(c=0;c<b;c+=1)y=e[c],d=i(y,c),s=h.get(d),s!==void 0&&((P=s.a)==null||P.measure(),(m??(m=new Set)).add(s));for(c=0;c<b;c+=1){if(y=e[c],d=i(y,c),s=h.get(d),s===void 0){var L=u?u.e.nodes_start:r;n=Ke(L,a,n,n===null?a.first:n.next,y,d,c,v,t,f),h.set(d,n),g=[],E=[],u=n.next;continue}if(A&&ca(s,y,c,t),(s.e.f&oe)!==0&&(Ie(s.e),l&&((U=s.a)==null||U.unfix(),(m??(m=new Set)).delete(s))),s!==u){if(p!==void 0&&p.has(s)){if(g.length<E.length){var M=E[0],k;n=M.prev;var q=g[0],x=g[g.length-1];for(k=0;k<g.length;k+=1)ge(g[k],M,r);for(k=0;k<E.length;k+=1)p.delete(E[k]);V(a,q.prev,x.next),V(a,n,q),V(a,x,M),u=M,n=x,c-=1,g=[],E=[]}else p.delete(s),ge(s,u,r),V(a,s.prev,s.next),V(a,s,n===null?a.first:n.next),V(a,n,s),n=s;continue}for(g=[],E=[];u!==null&&u.k!==d;)(u.e.f&oe)===0&&(p??(p=new Set)).add(u),E.push(u),u=u.next;if(u===null)continue;s=u}g.push(s),n=s,u=s.next}if(u!==null||p!==void 0){for(var S=p===void 0?[]:Se(p);u!==null;)(u.e.f&oe)===0&&S.push(u),u=u.next;var O=S.length;if(O>0){var D=(t&xe)!==0&&b===0?r:null;if(l){for(c=0;c<O;c+=1)(B=S[c].a)==null||B.measure();for(c=0;c<O;c+=1)(_=S[c].a)==null||_.fix()}fa(a,S,D,h)}}l&&Ze(()=>{var T;if(m!==void 0)for(s of m)(T=s.a)==null||T.apply()}),me.first=a.first&&a.first.e,me.last=n&&n.e}function ca(e,a,r,v){(v&de)!==0&&ye(e.v,a),(v&_e)!==0?ye(e.i,r):e.i=r}function Ke(e,a,r,v,t,i,f,l,A,b){var h=(A&de)!==0,H=(A&Qe)===0,u=h?H?Y(t):he(t):t,p=(A&_e)===0?f:he(f),n={i:p,v:u,k:i,a:null,e:null,prev:r,next:v};try{return n.e=Ee(()=>l(e,u,p,b),K),n.e.prev=r&&r.e,n.e.next=v&&v.e,r===null?a.first=n:(r.next=n,r.e.next=n.e),v!==null&&(v.prev=n,v.e.prev=n.e),n}finally{}}function ge(e,a,r){for(var v=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,i=e.e.nodes_start;i!==v;){var f=Xe(i);t.before(i),i=f}}function V(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const _a=Symbol("is custom element"),da=Symbol("is html");function Q(e){if(K){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var v=e.value;be(e,"value",null),e.value=v}if(e.hasAttribute("checked")){var t=e.checked;be(e,"checked",null),e.checked=t}}};e.__on_r=r,ea(r),oa()}}function be(e,a,r,v){var t=pa(e);K&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[aa]=r),e.removeAttribute(a))}function pa(e){return e.__attributes??(e.__attributes={[_a]:e.nodeName.includes("-"),[da]:e.namespaceURI===ra})}function X(e,a,r=a){var v=ta();Oe(e,"input",t=>{var i=t?e.defaultValue:e.value;if(i=ve(e)?fe(i):i,r(i),v&&i!==(i=a())){var f=e.selectionStart,l=e.selectionEnd;e.value=i??"",l!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(l,e.value.length))}}),(K&&e.defaultValue!==e.value||na(a)==null&&e.value)&&r(ve(e)?fe(e.value):e.value),la(()=>{var t=a();ve(e)&&t===fe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function ve(e){var a=e.type;return a==="number"||a==="range"}function fe(e){return e===""?null:+e}function $e(e,a,r){if(e.multiple)return ya(e,a);for(var v of e.options){var t=ee(v);if(ia(t,a)){v.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function ha(e,a){Te(()=>{var r=new MutationObserver(()=>{var v=e.__value;$e(e,v)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function ma(e,a,r=a){var v=!0;Oe(e,"change",t=>{var i=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(i),ee);else{var l=e.querySelector(i)??e.querySelector("option:not([disabled])");f=l&&ee(l)}r(f)}),Te(()=>{var t=a();if($e(e,t,v),v&&t===void 0){var i=e.querySelector(":checked");i!==null&&(t=ee(i),r(t))}e.__value=t,v=!1}),ha(e)}function ya(e,a){for(var r of e.options)r.selected=~a.indexOf(ee(r))}function ee(e){return"__value"in e?e.__value:e.value}const ce="https://script.google.com/macros/s/AKfycbx37QQFI7hnNU6Hv4E2AsZHBm4CO0u2uWko42K6grUJoEI4vI7krWXa1GxEADLZjH9x/exec",ga=localStorage.getItem("api_key"),ae=va(ga);ae.subscribe(e=>{localStorage.setItem("api_key",e||"")});var ba=N("<p>API-nyckel saknas.</p> <button>Ange API-nyckel</button>",1),Aa=N("<p>Laddar lagersaldo...</p>"),ka=N('<p style="color: red;"> </p>'),Ia=N("<th> </th>"),Ea=N("<td> </td>"),Sa=N("<tr></tr>"),xa=N("<table><thead><tr></tr></thead><tbody></tbody></table>"),Ta=N("<p>Inget saldo tillgängligt.</p>"),wa=N("<h2>Lagersaldo</h2> <!>",1);function Na(e,a){we(a,!1);const[r,v]=Ce(),t=()=>He(ae,"$apiKey",r);let i=Y([]),f=Y(!1),l=Y(null);async function A(){R(f,!0),R(l,null);try{const n=await fetch(`${ce}?key=${t()}&type=saldo`);if(!n.ok)throw new Error(`Fel vid hämtning: ${n.status}`);const m=await n.json();R(i,Array.isArray(m.saldo)?m.saldo:[])}catch(n){R(l,n.message)}finally{R(f,!1)}}function b(){const n=prompt("Ange din API-nyckel:");n&&ae.set(n)}Ne(()=>t(),()=>{t()&&A()}),Le(),Ae();var h=wa(),H=I(ne(h),2);{var u=n=>{var m=ba(),g=I(ne(m),2);ue("click",g,b),w(n,m)},p=(n,m)=>{{var g=y=>{var d=Aa();w(y,d)},E=(y,d)=>{{var s=L=>{var M=ka(),k=J(M,!0);C(M),W(()=>z(k,o(l))),w(L,M)},c=(L,M)=>{{var k=x=>{var S=xa(),O=J(S),D=J(O);te(D,5,()=>Object.keys(o(i)[0]),re,(U,B)=>{var _=Ia(),T=J(_,!0);C(_),W(()=>z(T,o(B))),w(U,_)}),C(D),C(O);var P=I(O);te(P,5,()=>o(i),re,(U,B)=>{var _=Sa();te(_,5,()=>Object.values(o(B)),re,(T,$)=>{var F=Ea(),le=J(F,!0);C(F),W(()=>z(le,o($))),w(T,F)}),C(_),w(U,_)}),C(P),C(S),w(x,S)},q=x=>{var S=Ta();w(x,S)};j(L,x=>{Array.isArray(o(i))&&o(i).length>0?x(k):x(q,!1)},M)}};j(y,L=>{o(l)?L(s):L(c,!1)},d)}};j(n,y=>{o(f)?y(g):y(E,!1)},m)}};j(H,n=>{t()?n(p,!1):n(u)})}w(e,h),Me(),v()}var La=N("<option> </option>"),Ma=N("<pre> </pre>"),Oa=N('<select><option disabled selected>Välj material</option><!></select> <input type="number" placeholder="Antal"> <input type="date"> <input type="date"> <h3>Ansvarig</h3> <input placeholder="Namn"> <input placeholder="E-post"> <input placeholder="Telefonnummer"> <button>Skicka bokning</button> <!>',1),Ca=N("<p>Laddar material eller saknar API-nyckel...</p>"),Ha=N('<h1>Boka material</h1> <input placeholder="Ange API-nyckel"> <button>Spara nyckel</button> <!> <!>',1);function Ua(e,a){we(a,!1);const[r,v]=Ce(),t=()=>He(ae,"$apiKey",r);let i=Y([]),f=Y(null),l=Y({materialId:"",antal:1,från:"",till:"",ansvarig:{namn:"",epost:"",telefonnummer:""}}),A=Y(t()||"");async function b(){const s=await(await fetch(`${ce}?key=${t()}`)).json();R(i,Array.isArray(s.material)?s.material:[])}function h(){ae.set(o(A)),b()}async function H(){R(f,null);const d=await fetch(`${ce}?key=${t()}`,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(o(l))});R(f,await d.json())}Ne(()=>t(),()=>{t()&&b()}),Le(),Ae();var u=Ha(),p=I(ne(u),2);Q(p);var n=I(p,2),m=I(n,2);{var g=d=>{var s=Oa(),c=ne(s);W(()=>{o(l),sa(()=>{o(i)})});var L=J(c);L.value=L.__value="";var M=I(L);te(M,1,()=>o(i),re,(_,T)=>{var $=La(),F={},le=J($,!0);C($),W(()=>{F!==(F=o(T).MaterialId)&&($.value=($.__value=o(T).MaterialId)??""),z(le,o(T).Namn)}),w(_,$)}),C(c);var k=I(c,2);Q(k);var q=I(k,2);Q(q);var x=I(q,2);Q(x);var S=I(x,4);Q(S);var O=I(S,2);Q(O);var D=I(O,2);Q(D);var P=I(D,2),U=I(P,2);{var B=_=>{var T=Ma(),$=J(T,!0);C(T),W(F=>z($,F),[()=>JSON.stringify(o(f),null,2)],ke),w(_,T)};j(U,_=>{o(f)&&_(B)})}ma(c,()=>o(l).materialId,_=>G(l,o(l).materialId=_)),X(k,()=>o(l).antal,_=>G(l,o(l).antal=_)),X(q,()=>o(l).från,_=>G(l,o(l).från=_)),X(x,()=>o(l).till,_=>G(l,o(l).till=_)),X(S,()=>o(l).ansvarig.namn,_=>G(l,o(l).ansvarig.namn=_)),X(O,()=>o(l).ansvarig.epost,_=>G(l,o(l).ansvarig.epost=_)),X(D,()=>o(l).ansvarig.telefonnummer,_=>G(l,o(l).ansvarig.telefonnummer=_)),ue("click",P,H),w(d,s)},E=d=>{var s=Ca();w(d,s)};j(m,d=>{Array.isArray(o(i))&&o(i).length>0?d(g):d(E,!1)})}var y=I(m,2);Na(y,{}),X(p,()=>o(A),d=>R(A,d)),ue("click",n,h),w(e,u),Me(),v()}export{Ua as component};
